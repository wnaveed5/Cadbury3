{"ast":null,"code":"// Purchase Order XML Template for NetSuite Integration\n// This template generates XML compatible with Big Faceless Report Generator (BFR)\n\nimport { processFormData } from './FormDataMapper';\n\n// Function to get current header colors from CSS variables\nfunction getHeaderColors() {\n  const root = document.documentElement;\n  const computedStyle = getComputedStyle(root);\n  return {\n    headerBackground: computedStyle.getPropertyValue('--header-background').trim() || '#000000',\n    headerText: computedStyle.getPropertyValue('--header-text').trim() || '#ffffff',\n    headerBorder: computedStyle.getPropertyValue('--header-border').trim() || 'rgba(255, 255, 255, 0.3)',\n    sectionTitleBackground: computedStyle.getPropertyValue('--section-title-background').trim() || '#f8fafc',\n    sectionTitleText: computedStyle.getPropertyValue('--section-title-text').trim() || '#374151'\n  };\n}\n\n// Function to generate XML from React form data\nexport function generatePurchaseOrderXML(formData, options = {}) {\n  var _fieldOrderData$compa, _fieldOrderData$purch, _formData$companyFiel, _data$companyFields, _fieldOrderData$compa2, _fieldOrderData$compa3;\n  // DEBUG: Log that we're using the DYNAMIC ID template\n  console.log('🚀 DYNAMIC ID TEMPLATE VERSION LOADED - generatePurchaseOrderXML called');\n  console.log('📅 Template updated at:', new Date().toISOString());\n  console.log('📊 Raw form data received:', formData);\n\n  // Get current header colors for XML generation\n  const headerColors = getHeaderColors();\n  console.log('🎨 Current header colors:', headerColors);\n\n  // Process and validate form data using the FormDataMapper\n  let processedData;\n  try {\n    processedData = processFormData(formData, {\n      calculateTotals: options.calculateTotals !== false,\n      validate: options.validate !== false,\n      formatForXML: true,\n      throwOnValidationError: options.throwOnValidationError || false\n    });\n    console.log('📊 Processed form data:', processedData);\n  } catch (error) {\n    console.error('❌ Form data processing failed:', error);\n    if (options.throwOnValidationError) {\n      throw error;\n    }\n    // Fallback to using raw data\n    processedData = formData || {};\n  }\n\n  // Merge processed data with original so ad-hoc fields (totals, shipping, UI line item keys) survive\n  // Prefer original ad-hoc keys when present (they reflect the live DOM at export time)\n  const data = {\n    ...(processedData || {}),\n    ...(formData || {})\n  };\n\n  // Normalize line items to expose both key styles expected by template rendering\n  if (Array.isArray(data.lineItems)) {\n    data.lineItems = data.lineItems.map(row => {\n      var _ref, _row$quantity, _ref2, _row$unitPrice, _ref3, _row$total, _row$qty, _row$rate, _row$amount, _row$quantity2, _row$unitPrice2, _row$total2;\n      const quantity = (_ref = (_row$quantity = row.quantity) !== null && _row$quantity !== void 0 ? _row$quantity : row.qty) !== null && _ref !== void 0 ? _ref : '';\n      const unitPrice = (_ref2 = (_row$unitPrice = row.unitPrice) !== null && _row$unitPrice !== void 0 ? _row$unitPrice : row.rate) !== null && _ref2 !== void 0 ? _ref2 : '';\n      const total = (_ref3 = (_row$total = row.total) !== null && _row$total !== void 0 ? _row$total : row.amount) !== null && _ref3 !== void 0 ? _ref3 : '';\n      return {\n        ...row,\n        qty: (_row$qty = row.qty) !== null && _row$qty !== void 0 ? _row$qty : quantity !== '' ? String(quantity) : '',\n        rate: (_row$rate = row.rate) !== null && _row$rate !== void 0 ? _row$rate : unitPrice !== '' ? String(unitPrice) : '',\n        amount: (_row$amount = row.amount) !== null && _row$amount !== void 0 ? _row$amount : total !== '' ? String(total) : '',\n        quantity: (_row$quantity2 = row.quantity) !== null && _row$quantity2 !== void 0 ? _row$quantity2 : quantity !== '' ? Number(String(quantity).replace(/[$,]/g, '')) : 0,\n        unitPrice: (_row$unitPrice2 = row.unitPrice) !== null && _row$unitPrice2 !== void 0 ? _row$unitPrice2 : unitPrice !== '' ? Number(String(unitPrice).replace(/[$,]/g, '')) : 0,\n        total: (_row$total2 = row.total) !== null && _row$total2 !== void 0 ? _row$total2 : total !== '' ? Number(String(total).replace(/[$,]/g, '')) : 0\n      };\n    });\n  }\n\n  // IMPORTANT: For field ordering, use the original formData to preserve drag-and-drop order\n  const fieldOrderData = {\n    ...data,\n    companyFields: formData.companyFields || data.companyFields || [],\n    purchaseOrderFields: formData.purchaseOrderFields || data.purchaseOrderFields || [],\n    vendorFields: formData.vendorFields || data.vendorFields || [],\n    shipToFields: formData.shipToFields || data.shipToFields || []\n  };\n\n  // DEBUG: Log field order data creation\n  console.log('🔍 DEBUG: fieldOrderData created with:');\n  console.log('🔍 DEBUG: - companyFields:', (_fieldOrderData$compa = fieldOrderData.companyFields) === null || _fieldOrderData$compa === void 0 ? void 0 : _fieldOrderData$compa.map(f => ({\n    id: f.id,\n    label: f.label\n  })));\n  console.log('🔍 DEBUG: - purchaseOrderFields:', (_fieldOrderData$purch = fieldOrderData.purchaseOrderFields) === null || _fieldOrderData$purch === void 0 ? void 0 : _fieldOrderData$purch.map(f => ({\n    id: f.id,\n    label: f.label\n  })));\n  console.log('🔍 DEBUG: - formData.companyFields:', (_formData$companyFiel = formData.companyFields) === null || _formData$companyFiel === void 0 ? void 0 : _formData$companyFiel.map(f => ({\n    id: f.id,\n    label: f.label\n  })));\n  console.log('🔍 DEBUG: - data.companyFields:', (_data$companyFields = data.companyFields) === null || _data$companyFields === void 0 ? void 0 : _data$companyFields.map(f => ({\n    id: f.id,\n    label: f.label\n  })));\n\n  // VALIDATION: Ensure field order data is robust and independent of section order\n  console.log('🔍 DEBUG: Field order data validation:');\n  console.log('🔍 DEBUG: - fieldOrderData.companyFields length:', (_fieldOrderData$compa2 = fieldOrderData.companyFields) === null || _fieldOrderData$compa2 === void 0 ? void 0 : _fieldOrderData$compa2.length);\n  console.log('🔍 DEBUG: - fieldOrderData.companyFields is array:', Array.isArray(fieldOrderData.companyFields));\n  console.log('🔍 DEBUG: - fieldOrderData.companyFields IDs:', (_fieldOrderData$compa3 = fieldOrderData.companyFields) === null || _fieldOrderData$compa3 === void 0 ? void 0 : _fieldOrderData$compa3.map(f => f.id));\n\n  // Ensure field order data is always available and valid\n  if (!Array.isArray(fieldOrderData.companyFields) || fieldOrderData.companyFields.length === 0) {\n    console.warn('⚠️ WARNING: companyFields is not available or empty, this may cause field order issues');\n  }\n\n  // Helper function to safely get field values with fallbacks (for simple fields)\n  const getFieldValue = (fieldName, defaultValue = '') => {\n    return data[fieldName] || defaultValue;\n  };\n\n  // Enhanced helper function to get field values by dynamic ID or static fallback\n  const getDynamicFieldValue = (fieldArray, possibleIds, defaultValue = '') => {\n    if (!fieldArray || !Array.isArray(fieldArray)) {\n      return defaultValue;\n    }\n\n    // Try each possible ID in order of preference\n    for (const fieldId of possibleIds) {\n      const field = fieldArray.find(f => f.id === fieldId);\n      if (field && field.value) {\n        return field.value;\n      }\n    }\n    return defaultValue;\n  };\n\n  // Helper function to get company field values with dynamic ID support\n  const getCompanyFieldValue = (staticId, defaultValue = '') => {\n    if (data.companyFields && Array.isArray(data.companyFields)) {\n      // First try the static ID, then try dynamic IDs that might have been generated\n      const possibleIds = [staticId, `company-field-${staticId}`, `${staticId}-${Date.now()}`, ...data.companyFields.filter(f => f.id.includes(staticId.replace('company-', ''))).map(f => f.id)];\n      return getDynamicFieldValue(data.companyFields, possibleIds, defaultValue);\n    }\n    return defaultValue;\n  };\n\n  // Helper function to get purchase order field values with dynamic ID support\n  const getPOFieldValue = (staticId, defaultValue = '') => {\n    if (data.purchaseOrderFields && Array.isArray(data.purchaseOrderFields)) {\n      const possibleIds = [staticId, `po-field-${staticId}`, `${staticId}-${Date.now()}`, ...data.purchaseOrderFields.filter(f => f.id.includes(staticId.replace('po-', ''))).map(f => f.id)];\n      return getDynamicFieldValue(data.purchaseOrderFields, possibleIds, defaultValue);\n    }\n    return defaultValue;\n  };\n\n  // Helper function to get vendor field values with dynamic ID support\n  const getVendorFieldValue = (staticId, defaultValue = '') => {\n    if (data.vendorFields && Array.isArray(data.vendorFields)) {\n      const possibleIds = [staticId, `vendor-field-${staticId}`, `${staticId}-${Date.now()}`, ...data.vendorFields.filter(f => f.id.includes(staticId.replace('vendor-', ''))).map(f => f.id)];\n      return getDynamicFieldValue(data.vendorFields, possibleIds, defaultValue);\n    }\n    return defaultValue;\n  };\n\n  // Helper function to get ship-to field values with dynamic ID support\n  const getShipToFieldValue = (staticId, defaultValue = '') => {\n    if (data.shipToFields && Array.isArray(data.shipToFields)) {\n      const possibleIds = [staticId, `ship-to-field-${staticId}`, `${staticId}-${Date.now()}`, ...data.shipToFields.filter(f => f.id.includes(staticId.replace('ship-to-', ''))).map(f => f.id)];\n      return getDynamicFieldValue(data.shipToFields, possibleIds, defaultValue);\n    }\n    return defaultValue;\n  };\n\n  // Helper function to get totals field values with dynamic ID support\n  const getTotalsFieldValue = (staticId, defaultValue = '') => {\n    if (data.totalsFields && Array.isArray(data.totalsFields)) {\n      const possibleIds = [staticId, `totals-field-${staticId}`, `${staticId}-${Date.now()}`, ...data.totalsFields.filter(f => f.id.includes(staticId)).map(f => f.id)];\n      return getDynamicFieldValue(data.totalsFields, possibleIds, defaultValue);\n    }\n    return defaultValue;\n  };\n\n  // --------------------------------------------------------------------------\n  // Generic label+value formatter for dynamic fields across sections\n  // Ensures fields like \"Tax ID Number\" render as \"Tax ID Number: 123...\"\n  // Avoids double-prefixing when the value already starts with the label/prefix\n  const formatFieldWithLabel = (field, rawValue) => {\n    const value = (rawValue !== null && rawValue !== void 0 ? rawValue : '').toString();\n    const labelText = ((field === null || field === void 0 ? void 0 : field.label) || (field === null || field === void 0 ? void 0 : field.id) || '').toString().replace(/:\\s*$/, '').trim();\n    if (!labelText) return value;\n    // If value already starts with the label or a known prefix, don't double prefix\n    const lowered = value.toLowerCase();\n    const loweredLabel = labelText.toLowerCase();\n    if (lowered.startsWith(`${loweredLabel}:`) || lowered.startsWith('phone:') || lowered.startsWith('fax:') || lowered.startsWith('website:')) {\n      return value || labelText; // if empty, show just label\n    }\n    if (!value) return labelText; // show label alone if no value\n    return `${labelText}: ${value}`;\n  };\n\n  // ============================================================================\n  // MODULAR XML BUILDER FUNCTIONS\n  // ============================================================================\n\n  // Build Company Information XML with dynamic field ordering (same pattern as section swapping)\n\n  const buildCompanyXML = (position = 'left') => {\n    var _data$fieldOrder, _data$sectionOrder;\n    // Get company fields from fieldOrderData to preserve drag-and-drop order\n    const companyFields = fieldOrderData.companyFields || [];\n\n    // CRITICAL: Get field order from data (same pattern as section order)\n    const fieldOrder = ((_data$fieldOrder = data.fieldOrder) === null || _data$fieldOrder === void 0 ? void 0 : _data$fieldOrder.company) || companyFields.map(f => f.id);\n    console.log('🔀 Building company XML with dynamic field ordering');\n    console.log('🔀 Company fields received from data:', companyFields.length);\n    console.log('🔀 Company fields IDs in current order:', companyFields.map(f => f.id));\n    console.log('🔀 Company fields labels in current order:', companyFields.map(f => f.label));\n    console.log('🔀 Company fields values in current order:', companyFields.map(f => f.value));\n    console.log('🔀 Field order from data:', fieldOrder);\n\n    // CRITICAL: Ensure field order is completely independent of section order\n    // The field order should be preserved exactly as it appears in fieldOrderData.companyFields\n    // regardless of whether this section is on the left or right\n    console.log('🔍 DEBUG: Field order independence verification:');\n    console.log('🔍 DEBUG: - Current section order:', (_data$sectionOrder = data.sectionOrder) === null || _data$sectionOrder === void 0 ? void 0 : _data$sectionOrder.sections1And2);\n    console.log('🔍 DEBUG: - Company fields order (should be independent):', companyFields.map(f => ({\n      id: f.id,\n      label: f.label,\n      position: companyFields.indexOf(f)\n    })));\n\n    // CRITICAL: Reorder fields based on fieldOrder (same pattern as section swapping)\n    const orderedCompanyFields = fieldOrder.map(fieldId => {\n      const field = companyFields.find(f => f.id === fieldId);\n      if (!field) {\n        console.warn(`⚠️ WARNING: Field with ID ${fieldId} not found in companyFields`);\n        return null;\n      }\n      return field;\n    }).filter(Boolean); // Remove any null fields\n\n    console.log('🔀 Ordered company fields for XML generation:', orderedCompanyFields.map(f => ({\n      id: f.id,\n      label: f.label,\n      position: orderedCompanyFields.indexOf(f)\n    })));\n\n    // Build rows dynamically based on ordered field order (same as section swapping)\n    const fieldRows = orderedCompanyFields.map((field, index) => {\n      const fieldValue = field.value || field.placeholder || '';\n      const isHeader = field.id === 'company-name';\n      console.log(`🔀 Processing field ${index}:`, {\n        id: field.id,\n        label: field.label,\n        value: fieldValue,\n        isHeader,\n        position: index\n      });\n      if (isHeader) {\n        const row = `<tr><td class=\"header-company\" style=\"text-align: left;\" data-field=\"${field.id}\">${fieldValue}</td></tr>`;\n        console.log(`🔀 Generated header row for ${field.id}:`, row);\n        return row;\n      } else {\n        // Prefix generic dynamic fields with their label (except known special cases handled by formatter)\n        const displayText = formatFieldWithLabel(field, fieldValue);\n        const row = `<tr><td style=\"text-align: left;\" data-field=\"${field.id}\">${displayText}</td></tr>`;\n        console.log(`🔀 Generated regular row for ${field.id}:`, row);\n        return row;\n      }\n    }).join('');\n    console.log('🔀 Final generated fieldRows:', fieldRows);\n\n    // Side-aware padding to keep spacing consistent when swapped\n    const companyTdPadding = position === 'left' ? 'padding-right: 24px;' : 'padding-left: 36px;';\n    const result = `\n      <td style=\"width: 65%; ${companyTdPadding}\" data-section=\"company-info\">\n        <table>\n          ${fieldRows}\n        </table>\n      </td>\n    `;\n    console.log('🔀 Final company XML result:', result);\n    return result;\n  };\n\n  // Build Company Information XML with NetSuite variables (FreeMarker syntax)\n  const buildCompanyNetSuiteXML = (position = 'left') => {\n    var _data$fieldOrder2;\n    // Get company fields from fieldOrderData to preserve drag-and-drop order\n    const companyFields = fieldOrderData.companyFields || [];\n\n    // Field mapping from form field IDs to NetSuite variables\n    const netSuiteFieldMapping = {\n      'company-name': '${companyInformation.companyName}',\n      'company-address': '${companyInformation.addressText}',\n      'company-phone': '${companyInformation.phone}',\n      'company-fax': '${companyInformation.fax}',\n      'company-email': '${companyInformation.email}',\n      'company-website': '${companyInformation.website}',\n      'company-tax-id': '${companyInformation.taxId}',\n      'company-duns': '${companyInformation.dunsNumber}',\n      'company-business-license': '${companyInformation.businessLicense}',\n      'company-registration': '${companyInformation.registrationNumber}'\n    };\n\n    // CRITICAL: Get field order from data (same pattern as section order)\n    const fieldOrder = ((_data$fieldOrder2 = data.fieldOrder) === null || _data$fieldOrder2 === void 0 ? void 0 : _data$fieldOrder2.company) || companyFields.map(f => f.id);\n    console.log('🔀 Building NetSuite company XML with dynamic field ordering');\n    console.log('🔀 Company fields received from data:', companyFields.length);\n    console.log('🔀 Field order from data:', fieldOrder);\n\n    // CRITICAL: Reorder fields based on fieldOrder\n    const orderedCompanyFields = fieldOrder.map(fieldId => {\n      const field = companyFields.find(f => f.id === fieldId);\n      if (!field) {\n        console.warn(`⚠️ WARNING: Field with ID ${fieldId} not found in companyFields`);\n        return null;\n      }\n      return field;\n    }).filter(Boolean);\n    console.log('🔀 Ordered company fields for NetSuite XML generation:', orderedCompanyFields.map(f => ({\n      id: f.id,\n      label: f.label\n    })));\n\n    // Build rows with NetSuite variables instead of hardcoded values\n    const fieldRows = orderedCompanyFields.map((field, index) => {\n      const isHeader = field.id === 'company-name';\n\n      // Get NetSuite variable for this field, or create a generic one\n      let netSuiteVariable = netSuiteFieldMapping[field.id];\n      if (!netSuiteVariable) {\n        // For dynamic fields, create a generic NetSuite variable\n        const cleanId = field.id.replace(/^company-/, '').replace(/-/g, '');\n        netSuiteVariable = `\\${companyInformation.${cleanId}}`;\n        console.log(`🔀 Generated dynamic NetSuite variable for ${field.id}: ${netSuiteVariable}`);\n      }\n      console.log(`🔀 Processing NetSuite field ${index}:`, {\n        id: field.id,\n        label: field.label,\n        netSuiteVariable,\n        isHeader,\n        position: index\n      });\n      if (isHeader) {\n        const row = `<tr><td class=\"header-company\" style=\"text-align: left;\" data-field=\"${field.id}\">${netSuiteVariable}</td></tr>`;\n        console.log(`🔀 Generated NetSuite header row for ${field.id}:`, row);\n        return row;\n      } else {\n        // For non-header fields, include label if it's not already in the NetSuite variable\n        const needsLabel = !['${companyInformation.addressText}', '${companyInformation.phone}', '${companyInformation.email}'].includes(netSuiteVariable);\n        const displayText = needsLabel ? `${field.label}: ${netSuiteVariable}` : netSuiteVariable;\n        const row = `<tr><td style=\"text-align: left;\" data-field=\"${field.id}\">${displayText}</td></tr>`;\n        console.log(`🔀 Generated NetSuite regular row for ${field.id}:`, row);\n        return row;\n      }\n    }).join('');\n    console.log('🔀 Final generated NetSuite fieldRows:', fieldRows);\n\n    // Side-aware padding to keep spacing consistent when swapped\n    const companyTdPadding = position === 'left' ? 'padding-right: 24px;' : 'padding-left: 36px;';\n    const result = `\n      <td style=\"width: 65%; ${companyTdPadding}\" data-section=\"company-info\">\n        <table>\n          ${fieldRows}\n        </table>\n      </td>\n    `;\n    console.log('🔀 Final NetSuite company XML result:', result);\n    return result;\n  };\n\n  // Build Purchase Order Information XML\n  const buildPurchaseOrderXML = (position = 'right') => {\n    var _data$fieldOrder3;\n    // Get purchase order fields from fieldOrderData to preserve drag-and-drop order\n    const purchaseOrderFields = fieldOrderData.purchaseOrderFields || [];\n\n    // CRITICAL: Get field order from data (same pattern as section order)\n    const fieldOrder = ((_data$fieldOrder3 = data.fieldOrder) === null || _data$fieldOrder3 === void 0 ? void 0 : _data$fieldOrder3.purchaseOrder) || purchaseOrderFields.map(f => f.id);\n    console.log('🔀 Building purchase order XML with dynamic field ordering');\n    console.log('🔀 Purchase order fields received from data:', purchaseOrderFields.length);\n    console.log('🔀 Purchase order fields IDs in current order:', purchaseOrderFields.map(f => f.id));\n    console.log('🔀 Field order from data:', fieldOrder);\n\n    // CRITICAL: Reorder fields based on fieldOrder (same pattern as section swapping)\n    const orderedPOFields = fieldOrder.map(fieldId => {\n      const field = purchaseOrderFields.find(f => f.id === fieldId);\n      if (!field) {\n        console.warn(`⚠️ WARNING: Field with ID ${fieldId} not found in purchaseOrderFields`);\n        return null;\n      }\n      return field;\n    }).filter(Boolean); // Remove any null fields\n\n    console.log('🔀 Ordered purchase order fields for XML generation:', orderedPOFields.map(f => ({\n      id: f.id,\n      label: f.label,\n      position: orderedPOFields.indexOf(f)\n    })));\n\n    // Build XML based on ordered fields\n    const fieldRows = orderedPOFields.map((field, index) => {\n      // Prefer captured value; fallback to template getters to ensure content always present\n      const isTitle = field.id === 'po-title';\n      if (isTitle) {\n        const value = field.value || getPOFieldValue('po-title', 'PURCHASE ORDER');\n        return `<tr><td class=\"header-title\" style=\"text-align: right;\" data-field=\"${field.id}\">${value}</td></tr>`;\n      }\n      if (field.id === 'po-date') {\n        const value = field.value || getPOFieldValue('po-date', 'MM/DD/YYYY');\n        return `<tr><td style=\"text-align: right;\"><table style=\"width: 100%;\"><tr><td class=\"header-info\" style=\"width: 30%; text-align: left;\"><b>DATE</b></td><td class=\"header-info\" style=\"width: 70%; text-align: left;\" data-field=\"po-date\">${value}</td></tr></table></td></tr>`;\n      }\n      if (field.id === 'po-number') {\n        const value = field.value || getPOFieldValue('po-number', '[PO Number]');\n        return `<tr><td style=\"text-align: right;\"><table style=\"width: 100%;\"><tr><td class=\"header-info\" style=\"width: 30%; text-align: left;\"><b>PO #</b></td><td class=\"header-info\" style=\"width: 70%; text-align: left;\" data-field=\"po-number\">${value}</td></tr></table></td></tr>`;\n      }\n      const genericValue = field.value || getPOFieldValue(field.id, '');\n      const displayText = formatFieldWithLabel(field, genericValue);\n      return `<tr><td style=\"text-align: right;\" data-field=\"${field.id}\">${displayText}</td></tr>`;\n    }).join('');\n\n    // Side-aware padding: when PO is on the left, push it away from the right column\n    const poTdPadding = position === 'left' ? 'padding-right: 56px;' : 'padding-left: 28px;';\n    return `\n      <td style=\"width: 35%; ${poTdPadding}\" align=\"right\" data-section=\"purchase-order-info\">\n        <table>\n          ${fieldRows}\n        </table>\n      </td>\n    `;\n  };\n\n  // Build Vendor-ShipTo Section XML with dynamic ordering\n  const buildVendorShipToSectionXML = () => {\n    var _data$sectionOrder2, _data$sectionOrder3;\n    // Get section order from data, default to [section3, section4] if not provided\n    const sectionOrder = ((_data$sectionOrder2 = data.sectionOrder) === null || _data$sectionOrder2 === void 0 ? void 0 : _data$sectionOrder2.sections3And4) || ['section3', 'section4'];\n    const leftSection = sectionOrder[0];\n    const rightSection = sectionOrder[1];\n    console.log('🔀 Building vendor-shipTo section with order:', {\n      leftSection,\n      rightSection\n    });\n    console.log('🔀 sections3And4 array:', (_data$sectionOrder3 = data.sectionOrder) === null || _data$sectionOrder3 === void 0 ? void 0 : _data$sectionOrder3.sections3And4);\n    let leftColumn, rightColumn;\n    if (leftSection === 'section3') {\n      // Default order: Vendor left, Ship To right\n      leftColumn = buildVendorXML();\n      rightColumn = buildShipToXML();\n      console.log('🔀 Using default order: Vendor left, Ship To right');\n    } else {\n      // Swapped order: Ship To left, Vendor right\n      leftColumn = buildShipToXML();\n      rightColumn = buildVendorXML();\n      console.log('🔀 Using swapped order: Ship To left, Vendor right');\n    }\n    return `\n      <table style=\"margin-top: 20px;\" data-section=\"vendor-ship-to\">\n        <tr>\n          ${leftColumn}\n          ${rightColumn}\n        </tr>\n      </table>\n    `;\n  };\n\n  // Build Shipping Details XML with dynamic column ordering\n  const buildShippingDetailsXML = () => {\n    var _data$sectionOrder4;\n    // Get shipping column order from data, default to standard order if not provided\n    const shippingColumnOrder = ((_data$sectionOrder4 = data.sectionOrder) === null || _data$sectionOrder4 === void 0 ? void 0 : _data$sectionOrder4.shippingColumns) || ['requisitioner', 'shipVia', 'fob', 'shippingTerms'];\n    console.log('🔀 Building shipping details with column order:', shippingColumnOrder);\n\n    // Column configuration mapping\n    const columnConfig = {\n      requisitioner: {\n        label: 'REQUISITIONER',\n        field: 'requisitioner'\n      },\n      shipVia: {\n        label: 'SHIP VIA',\n        field: 'shipVia'\n      },\n      fob: {\n        label: 'F.O.B.',\n        field: 'fob'\n      },\n      shippingTerms: {\n        label: 'SHIPPING TERMS',\n        field: 'shippingTerms'\n      }\n    };\n\n    // Helper function to get column configuration (handles custom columns)\n    const getColumnConfig = columnId => {\n      // Check if it's a standard column\n      if (columnConfig[columnId]) {\n        return columnConfig[columnId];\n      }\n\n      // Handle custom columns (those that start with 'custom-')\n      if (columnId.startsWith('custom-')) {\n        return {\n          label: columnId.toUpperCase().replace('custom-', 'CUSTOM '),\n          field: columnId\n        };\n      }\n\n      // Fallback for unknown columns\n      console.warn(`⚠️ Unknown shipping column: ${columnId}`);\n      return {\n        label: columnId.toUpperCase(),\n        field: columnId\n      };\n    };\n\n    // Build header row\n    const headerCells = shippingColumnOrder.map(columnId => {\n      const config = getColumnConfig(columnId);\n      return `<td class=\"section-header\" style=\"width: 25%;\">${config.label}</td>`;\n    }).join('');\n\n    // Build content row\n    const contentCells = shippingColumnOrder.map(columnId => {\n      const config = getColumnConfig(columnId);\n      return `<td class=\"section-content\" data-field=\"${config.field}\">${getShippingFieldValue(config.field, `[${config.label}]`)}</td>`;\n    }).join('');\n    return `\n      <table style=\"margin-top: 15px;\" data-section=\"shipping-details\">\n        <tr>\n          ${headerCells}\n        </tr>\n        <tr>\n          ${contentCells}\n        </tr>\n      </table>\n    `;\n  };\n\n  // Build Vendor-ShipTo AND Shipping Details sections with vertical swapping\n  const buildVendorShipToAndShippingDetailsXML = () => {\n    // Get major sections order from data - this is the new state for group swapping\n    const majorSectionsOrder = data.majorSectionsOrder || ['vendor-shipto-group', 'shipping-section'];\n    const topSection = majorSectionsOrder[0];\n    const bottomSection = majorSectionsOrder[1];\n    console.log('🔀 Building vendor-shipTo + shipping details with majorSectionsOrder:', {\n      topSection,\n      bottomSection\n    });\n    console.log('🔀 majorSectionsOrder array:', data.majorSectionsOrder);\n    let topContent, bottomContent;\n    if (topSection === 'vendor-shipto-group') {\n      // Default order: Vendor-ShipTo group on top, Shipping Details below\n      topContent = buildVendorShipToSectionXML();\n      bottomContent = buildShippingDetailsXML();\n      console.log('🔀 Using default order: Vendor-ShipTo group top, Shipping section bottom');\n    } else {\n      // Swapped order: Shipping Details on top, Vendor-ShipTo group below\n      topContent = buildShippingDetailsXML();\n      bottomContent = buildVendorShipToSectionXML();\n      console.log('🔀 Using swapped order: Shipping section top, Vendor-ShipTo group bottom');\n    }\n    return `\n      ${topContent}\n      ${bottomContent}\n    `;\n  };\n\n  // Build Header Section XML (Company + Purchase Order) with dynamic ordering\n  const buildHeaderSectionXML = () => {\n    var _data$sectionOrder5, _data$sectionOrder6, _data$sectionOrder7, _data$sectionOrder8, _data$sectionOrder8$s, _data$sectionOrder9, _fieldOrderData$compa4, _fieldOrderData$purch2;\n    // Get section order from data, default to [section1, section2] if not provided\n    const sectionOrder = ((_data$sectionOrder5 = data.sectionOrder) === null || _data$sectionOrder5 === void 0 ? void 0 : _data$sectionOrder5.sections1And2) || ['section1', 'section2'];\n    const leftSection = sectionOrder[0];\n    const rightSection = sectionOrder[1];\n    console.log('🔀 Building header section with order:', {\n      leftSection,\n      rightSection\n    });\n    console.log('🔀 Full sectionOrder data:', data.sectionOrder);\n    console.log('🔀 Full data object keys:', Object.keys(data));\n    console.log('🔀 sections1And2 array:', (_data$sectionOrder6 = data.sectionOrder) === null || _data$sectionOrder6 === void 0 ? void 0 : _data$sectionOrder6.sections1And2);\n    console.log('🔀 sections1And2 type:', typeof ((_data$sectionOrder7 = data.sectionOrder) === null || _data$sectionOrder7 === void 0 ? void 0 : _data$sectionOrder7.sections1And2));\n    console.log('🔀 sections1And2 length:', (_data$sectionOrder8 = data.sectionOrder) === null || _data$sectionOrder8 === void 0 ? void 0 : (_data$sectionOrder8$s = _data$sectionOrder8.sections1And2) === null || _data$sectionOrder8$s === void 0 ? void 0 : _data$sectionOrder8$s.length);\n    console.log('🔀 sections1And2 values:', JSON.stringify((_data$sectionOrder9 = data.sectionOrder) === null || _data$sectionOrder9 === void 0 ? void 0 : _data$sectionOrder9.sections1And2));\n\n    // DEBUG: Check field order data when building header\n    console.log('🔍 DEBUG: fieldOrderData.companyFields when building header:', (_fieldOrderData$compa4 = fieldOrderData.companyFields) === null || _fieldOrderData$compa4 === void 0 ? void 0 : _fieldOrderData$compa4.map(f => ({\n      id: f.id,\n      label: f.label\n    })));\n    console.log('🔍 DEBUG: fieldOrderData.purchaseOrderFields when building header:', (_fieldOrderData$purch2 = fieldOrderData.purchaseOrderFields) === null || _fieldOrderData$purch2 === void 0 ? void 0 : _fieldOrderData$purch2.map(f => ({\n      id: f.id,\n      label: f.label\n    })));\n\n    // IMPORTANT: Field order should be completely independent of section order\n    // Always use the current field order from fieldOrderData, regardless of section position\n    console.log('🔍 DEBUG: Ensuring field order independence from section order');\n    let leftColumn, rightColumn;\n    if (leftSection === 'section1') {\n      // Company on left, Purchase Order on right\n      leftColumn = buildCompanyXML('left');\n      rightColumn = buildPurchaseOrderXML('right');\n      console.log('🔀 Using default order: Company left, Purchase Order right');\n    } else {\n      // Purchase Order on left, Company on right (sections swapped)\n      leftColumn = buildPurchaseOrderXML('left');\n      rightColumn = buildCompanyXML('right');\n      console.log('🔀 Using swapped order: Purchase Order left, Company right');\n    }\n\n    // DEBUG: Verify that field order is preserved regardless of section position\n    console.log('🔍 DEBUG: Field order verification - Company fields should maintain custom order');\n    console.log('🔍 DEBUG: Final company XML will use fieldOrderData.companyFields order');\n    return `\n      <table>\n        <tr>\n          ${leftColumn}\n          ${rightColumn}\n        </tr>\n      </table>\n    `;\n  };\n\n  // Build Vendor Information XML (dynamic label prefixing for all fields)\n  const buildVendorXML = () => {\n    var _data$fieldOrder4;\n    // Get field order for vendor; fallback to current array order if not provided\n    const vendorFields = fieldOrderData.vendorFields || [];\n    const vendorFieldOrder = ((_data$fieldOrder4 = data.fieldOrder) === null || _data$fieldOrder4 === void 0 ? void 0 : _data$fieldOrder4.vendor) || vendorFields.map(f => f.id);\n    const orderedVendorFields = vendorFieldOrder.map(fieldId => vendorFields.find(f => f.id === fieldId)).filter(Boolean);\n    const rows = orderedVendorFields.map(f => {\n      const raw = f.value || getVendorFieldValue(f.id, '');\n      const display = formatFieldWithLabel(f, raw);\n      return `<span data-field=\"${f.id}\">${display}</span>`;\n    }).join('<br/>');\n    return `\n      <td style=\"width: 50%;\" data-subsection=\"vendor\">\n        <table>\n          <tr>\n            <td class=\"section-header\">VENDOR</td>\n          </tr>\n          <tr>\n            <td class=\"section-content\">${rows}</td>\n          </tr>\n        </table>\n      </td>\n    `;\n  };\n\n  // Build Ship To Information XML (dynamic label prefixing for all fields)\n  const buildShipToXML = () => {\n    var _data$fieldOrder5;\n    // Get field order for ship-to; fallback to current array order if not provided\n    const shipToFields = fieldOrderData.shipToFields || [];\n    const shipToFieldOrder = ((_data$fieldOrder5 = data.fieldOrder) === null || _data$fieldOrder5 === void 0 ? void 0 : _data$fieldOrder5.shipTo) || shipToFields.map(f => f.id);\n    const orderedShipToFields = shipToFieldOrder.map(fieldId => shipToFields.find(f => f.id === fieldId)).filter(Boolean);\n    const rows = orderedShipToFields.map(f => {\n      const raw = f.value || getShipToFieldValue(f.id, '');\n      const display = formatFieldWithLabel(f, raw);\n      return `<span data-field=\"${f.id}\">${display}</span>`;\n    }).join('<br/>');\n    return `\n      <td style=\"width: 50%;\" data-subsection=\"ship-to\">\n        <table>\n          <tr>\n            <td class=\"section-header\">SHIP TO</td>\n          </tr>\n          <tr>\n            <td class=\"section-content\">${rows}</td>\n          </tr>\n        </table>\n      </td>\n    `;\n  };\n\n  // Build Vendor/Ship-To Section XML with dynamic ordering\n  const buildVendorShipToXML = () => {\n    var _data$sectionOrder0;\n    // Get section order from data, default to [section3, section4] if not provided\n    const sectionOrder = ((_data$sectionOrder0 = data.sectionOrder) === null || _data$sectionOrder0 === void 0 ? void 0 : _data$sectionOrder0.sections3And4) || ['section3', 'section4'];\n    const leftSection = sectionOrder[0];\n    const rightSection = sectionOrder[1];\n    console.log('🔀 Building vendor/ship-to section with order:', {\n      leftSection,\n      rightSection\n    });\n    let leftColumn, rightColumn;\n    if (leftSection === 'section3') {\n      leftColumn = buildVendorXML();\n      rightColumn = buildShipToXML();\n    } else {\n      leftColumn = buildShipToXML();\n      rightColumn = buildVendorXML();\n    }\n    return `\n      <table style=\"margin-top: 20px;\" data-section=\"vendor-ship-to\">\n        <tr>\n          ${leftColumn}\n          ${rightColumn}\n        </tr>\n      </table>\n    `;\n  };\n\n  // Build Line Items XML with dynamic column ordering\n  const buildLineItemsXML = () => {\n    var _data$sectionOrder1, _data$sectionOrder10;\n    // Get column order from data, default to standard order if not provided\n    const columnOrder = ((_data$sectionOrder1 = data.sectionOrder) === null || _data$sectionOrder1 === void 0 ? void 0 : _data$sectionOrder1.lineItemColumns) || ['itemNumber', 'description', 'qty', 'rate', 'amount'];\n    console.log('🔀 Building line items with column order:', columnOrder);\n    console.log('🔀 Line items data:', data.lineItems);\n    console.log('🔀 Column order from state:', (_data$sectionOrder10 = data.sectionOrder) === null || _data$sectionOrder10 === void 0 ? void 0 : _data$sectionOrder10.lineItemColumns);\n    console.log('🔀 Full data object:', data);\n\n    // Column configuration mapping\n    const columnConfig = {\n      itemNumber: {\n        label: 'Item#',\n        colSpan: 3,\n        field: 'itemNumber'\n      },\n      description: {\n        label: 'Description',\n        colSpan: 12,\n        field: 'description'\n      },\n      qty: {\n        label: 'Qty',\n        colSpan: 2,\n        field: 'qty'\n      },\n      rate: {\n        label: 'Rate',\n        colSpan: 3,\n        field: 'rate'\n      },\n      amount: {\n        label: 'Amount',\n        colSpan: 3,\n        field: 'amount'\n      }\n    };\n\n    // Build header row\n    const headerRow = columnOrder.map(columnId => {\n      let config, label;\n      if (columnId.startsWith('custom-')) {\n        // Handle custom columns\n        const customType = columnId.replace('custom-', '').split('-')[0]; // Get first part after 'custom-'\n        label = customType.charAt(0).toUpperCase() + customType.slice(1); // Capitalize first letter\n        config = {\n          colSpan: 3\n        }; // Default colSpan for custom columns\n        console.log(`🔀 Custom column \"${columnId}\" -> label: \"${label}\", colSpan: ${config.colSpan}`);\n      } else {\n        // Handle standard columns\n        config = columnConfig[columnId];\n        label = config.label;\n        console.log(`🔀 Standard column \"${columnId}\" -> label: \"${label}\", colSpan: ${config.colSpan}`);\n      }\n      return `<td class=\"item-header\" colSpan=\"${config.colSpan}\">${label}</td>`;\n    }).join('');\n\n    // Build data rows using actual line item data\n    const lineItems = data.lineItems || [];\n    const actualRowCount = lineItems.length;\n    console.log(`🔀 Building ${actualRowCount} data rows from line items data`);\n    const dataRows = lineItems.map((rowData, rowIndex) => {\n      const rowCells = columnOrder.map(columnId => {\n        let config, fieldValue;\n        if (columnId.startsWith('custom-')) {\n          // Handle custom columns\n          config = {\n            colSpan: 3\n          }; // Default colSpan for custom columns\n          fieldValue = rowData[columnId] || '-';\n          console.log(`🔀 Custom column \"${columnId}\" row ${rowIndex}: value = \"${fieldValue}\"`);\n        } else {\n          // Handle standard columns\n          config = columnConfig[columnId];\n          // Resolve value with fallbacks between UI keys and numeric keys\n          fieldValue = rowData[columnId];\n          if (fieldValue === undefined || fieldValue === null || fieldValue === '') {\n            if (columnId === 'qty') fieldValue = rowData.quantity;else if (columnId === 'rate') fieldValue = rowData.unitPrice;else if (columnId === 'amount') fieldValue = rowData.total;\n          }\n          if (fieldValue === undefined || fieldValue === null || fieldValue === '') fieldValue = '-';\n          console.log(`🔀 Standard column \"${columnId}\" row ${rowIndex}: value = \"${fieldValue}\"`);\n        }\n        return `<td colSpan=\"${config.colSpan}\">${fieldValue}</td>`;\n      }).join('');\n      return `<tr data-row-id=\"line-item-${rowIndex}\" data-row-index=\"${rowIndex}\">${rowCells}</tr>`;\n    }).join('');\n    return `\n      <table style=\"margin-top: 15px;\" data-section=\"line-items\">\n        <tr>\n          ${headerRow}\n        </tr>\n        ${dataRows}\n      </table>\n    `;\n  };\n\n  // Build Comments Section XML\n  const buildCommentsXML = () => {\n    // Get comments fields order from data, default to standard order if not provided\n    const commentsFieldsOrder = data.commentsFields || [{\n      id: 'comments-main',\n      label: 'Comments or Special Instructions:',\n      value: '[Enter comments or special instructions...]'\n    }];\n\n    // Helper function to get field value with fallbacks\n    const getCommentsFieldValue = fieldId => {\n      // Try data object first, then field value, then default\n      if (data[fieldId] !== undefined && String(data[fieldId]).trim()) {\n        return data[fieldId];\n      }\n      const field = commentsFieldsOrder.find(f => f.id === fieldId);\n      if (field && field.value) {\n        return field.value;\n      }\n\n      // Fallback to DOM lookup\n      const element = document.querySelector(`[data-field=\"${fieldId}\"] .editable-field`);\n      if (element && element.textContent.trim()) {\n        return element.textContent.trim();\n      }\n      return '[Enter comments or special instructions...]';\n    };\n\n    // Build table rows dynamically based on commentsFields order\n    const commentsRows = commentsFieldsOrder.map(field => {\n      const value = getCommentsFieldValue(field.id);\n      return `\n        <tr>\n          <td class=\"comments-header\">${field.label}</td>\n        </tr>\n        <tr>\n          <td class=\"comments-content\">${value}</td>\n        </tr>\n      `;\n    }).join('');\n    return `\n      <td style=\"width: 50%;\" data-section=\"comments\">\n        <table>\n          ${commentsRows}\n        </table>\n      </td>\n    `;\n  };\n\n  // Build Contact Section XML\n  const buildContactXML = () => {\n    // Get contact fields order from data, default to standard order if not provided\n    const contactFieldsOrder = data.contactFields || [{\n      id: 'contact-main',\n      label: 'Contact Information:',\n      value: 'For inquiries, please contact us'\n    }];\n\n    // Helper function to get field value with fallbacks\n    const getContactFieldValue = fieldId => {\n      // Try data object first, then field value, then default\n      if (data[fieldId] !== undefined && String(data[fieldId]).trim()) {\n        return data[fieldId];\n      }\n      const field = contactFieldsOrder.find(f => f.id === fieldId);\n      if (field && field.value) {\n        return field.value;\n      }\n\n      // Fallback to DOM lookup\n      const element = document.querySelector(`[data-field=\"${fieldId}\"] .editable-field`);\n      if (element && element.textContent.trim()) {\n        return element.textContent.trim();\n      }\n      return 'For inquiries, please contact us';\n    };\n\n    // Build table rows dynamically based on contactFields order\n    const contactRows = contactFieldsOrder.map(field => {\n      const value = getContactFieldValue(field.id);\n      return `\n        <tr>\n          <td class=\"contact-header\">${field.label}</td>\n        </tr>\n        <tr>\n          <td class=\"contact-content\">${value}</td>\n        </tr>\n      `;\n    }).join('');\n    return `\n      <td class=\"contact-info\" style=\"width: 70%;\" data-field=\"contact-info\">\n        <table>\n          ${contactRows}\n        </table>\n      </td>\n    `;\n  };\n\n  // Build Totals Section XML\n  const buildTotalsXML = () => {\n    // Get totals fields order from data, default to standard order if not provided\n    const totalsFieldsOrder = data.totalsFields || [{\n      id: 'subtotal',\n      label: 'SUBTOTAL:',\n      value: '$0.00'\n    }, {\n      id: 'tax',\n      label: 'TAX:',\n      value: '$0.00'\n    }, {\n      id: 'shipping',\n      label: 'SHIPPING:',\n      value: '$0.00'\n    }, {\n      id: 'other',\n      label: 'OTHER:',\n      value: '$0.00'\n    }, {\n      id: 'total',\n      label: 'TOTAL:',\n      value: '$0.00'\n    }];\n\n    // Helper function to get field value with fallbacks\n    const getFieldValue = fieldId => {\n      // Try data object first, then field value, then default\n      if (data[fieldId] !== undefined && String(data[fieldId]).trim()) {\n        return data[fieldId];\n      }\n      const field = totalsFieldsOrder.find(f => f.id === fieldId);\n      if (field && field.value) {\n        return field.value;\n      }\n\n      // Fallback to DOM lookup\n      const element = document.querySelector(`[data-field=\"${fieldId}\"] .editable-field, [data-field=\"${fieldId}\"] .calculated-field`);\n      if (element && element.textContent.trim()) {\n        return element.textContent.trim();\n      }\n      return '$0.00';\n    };\n\n    // Build table rows dynamically based on totalsFields order\n    const totalsRows = totalsFieldsOrder.map(field => {\n      const value = getFieldValue(field.id);\n      return `\n        <tr>\n          <td class=\"total-label\">${field.label}</td>\n          <td class=\"total-amount\" align=\"right\">${value}</td>\n        </tr>\n      `;\n    }).join('');\n\n    // Use table rows/cells for maximum NetSuite/BFO compatibility (avoid nested divs)\n    return `\n      <td style=\"width: 50%;\" data-section=\"totals\">\n        <table>\n          <tr>\n            <td class=\"section-header\" colspan=\"2\">Totals</td>\n          </tr>\n          ${totalsRows}\n        </table>\n      </td>\n    `;\n  };\n\n  // Build Comments and Totals Section XML with dynamic ordering\n  const buildCommentsTotalsXML = () => {\n    var _data$sectionOrder11;\n    // Get section order from data, default to [section8, section9] if not provided\n    const sectionOrder = ((_data$sectionOrder11 = data.sectionOrder) === null || _data$sectionOrder11 === void 0 ? void 0 : _data$sectionOrder11.sections8And9) || ['section8', 'section9'];\n    const leftSection = sectionOrder[0];\n    const rightSection = sectionOrder[1];\n    console.log('🔀 Building comments/totals section with order:', {\n      leftSection,\n      rightSection\n    });\n    let leftColumn, rightColumn;\n    if (leftSection === 'section8') {\n      leftColumn = buildCommentsXML();\n      rightColumn = buildTotalsXML();\n    } else {\n      leftColumn = buildTotalsXML();\n      rightColumn = buildCommentsXML();\n    }\n    return `\n      <table style=\"margin-top: 15px;\" data-section=\"comments-totals\">\n        <tr>\n          ${leftColumn}\n          ${rightColumn}\n        </tr>\n      </table>\n    `;\n  };\n\n  // Helper function to get shipping details field values with dynamic ID support\n  const getShippingFieldValue = (fieldType, defaultValue = '') => {\n    // Try to get value from data object first (this includes custom columns)\n    if (data[fieldType] !== undefined && data[fieldType] !== '') {\n      return data[fieldType];\n    }\n    const possibleSelectors = [`.shipping-field-${fieldType} .editable-field`, `.shipping-field[data-field=\"${fieldType}\"] .editable-field`, `.shipping-${fieldType} .editable-field`, `#shipping-${fieldType}`, `[data-shipping-field=\"${fieldType}\"]`];\n\n    // Try DOM selectors as fallback\n    for (const selector of possibleSelectors) {\n      const element = document.querySelector(selector);\n      if (element && element.textContent.trim()) {\n        return element.textContent.trim();\n      }\n    }\n    return defaultValue;\n  };\n\n  // Helper function to get line item values with dynamic ID support\n  const getLineItemValue = (rowIndex, fieldType, defaultValue = '') => {\n    // Map template field names to live table data-column ids\n    const colIdMap = {\n      quantity: 'qty',\n      unitPrice: 'rate',\n      total: 'amount'\n    };\n    const colId = colIdMap[fieldType] || fieldType; // itemNumber, description pass through\n\n    const possibleSelectors = [`#line-item-${rowIndex}-${fieldType}`, `.line-item-row[data-row=\"${rowIndex}\"] .${colId}-field`, `.itemtable tbody tr:nth-child(${rowIndex + 1}) .${colId}-field .editable-field`, `.itemtable tbody tr:nth-child(${rowIndex + 1}) td[data-column=\"${colId}\"] .editable-field`, `.itemtable tbody tr:nth-child(${rowIndex + 1}) td:nth-child(${getColumnIndex(fieldType)}) .editable-field`];\n\n    // Try data object first\n    if (data.lineItems && data.lineItems[rowIndex] && data.lineItems[rowIndex][fieldType]) {\n      return data.lineItems[rowIndex][fieldType];\n    }\n\n    // Try DOM selectors with debugging\n    for (const selector of possibleSelectors) {\n      const element = document.querySelector(selector);\n      const text = element ? element.textContent.trim() : '';\n      try {\n        console.debug('🔎 XML getLineItemValue', {\n          rowIndex,\n          fieldType,\n          colId,\n          selector,\n          found: !!element,\n          text\n        });\n      } catch {}\n      if (text) return text;\n    }\n    return defaultValue;\n  };\n\n  // Helper function to get column index for line items\n  const getColumnIndex = fieldType => {\n    const columnMap = {\n      itemNumber: 2,\n      description: 3,\n      quantity: 4,\n      unitPrice: 5,\n      total: 6\n    };\n    return columnMap[fieldType] || 1;\n  };\n\n  // Helper function to get totals field values with dynamic ID support\n  const getTotalFieldValue = (fieldType, defaultValue = '') => {\n    const possibleSelectors = [`#total-${fieldType}`, `.total-${fieldType} .editable-field`, `.total-row[data-field=\"${fieldType}\"] .editable-field`, `.totals-section .${fieldType}-field .editable-field`,\n    // Subtotal and total are displayed as calculated spans\n    `.totals-section .total-row[data-field=\"subtotal\"] .calculated-field`, `.totals-section .total-row[data-field=\"total\"] .total-field`];\n\n    // Try data object first\n    if (data[fieldType]) {\n      return data[fieldType];\n    }\n\n    // Try DOM selectors with debugging\n    for (const selector of possibleSelectors) {\n      const element = document.querySelector(selector);\n      const text = element ? element.textContent.trim() : '';\n      try {\n        console.debug('🔎 XML getTotalFieldValue', {\n          fieldType,\n          selector,\n          found: !!element,\n          text\n        });\n      } catch {}\n      if (text) return text;\n    }\n    return defaultValue;\n  };\n\n  // Helper function to get comments field value with dynamic ID support\n  const getCommentsValue = (defaultValue = '') => {\n    const possibleSelectors = ['#comments-field', '.comments-content .editable-field', '.comments-section .editable-field', '[data-field=\"comments\"]'];\n\n    // Try data object first\n    if (data.comments) {\n      return data.comments;\n    }\n\n    // Try DOM selectors\n    for (const selector of possibleSelectors) {\n      const element = document.querySelector(selector);\n      if (element && element.textContent.trim()) {\n        return element.textContent.trim();\n      }\n    }\n    return defaultValue;\n  };\n\n  // Helper function to get contact info field value with dynamic ID support\n  const getContactInfoValue = (defaultValue = '') => {\n    const possibleSelectors = ['#contact-info-field', '.contact-section .editable-field', '.contact-info .editable-field', '[data-field=\"contactInfo\"]'];\n\n    // Try data object first\n    if (data.contactInfo) {\n      return data.contactInfo;\n    }\n\n    // Try DOM selectors\n    for (const selector of possibleSelectors) {\n      const element = document.querySelector(selector);\n      if (element && element.textContent.trim()) {\n        return element.textContent.trim();\n      }\n    }\n    return defaultValue;\n  };\n\n  // Generate line items XML with dynamic ID support\n  const generateLineItemsXML = () => {\n    const maxRows = 5; // Standard number of line item rows\n\n    // Generate rows (either from data or empty placeholder rows)\n    return Array(maxRows).fill(0).map((_, index) => {\n      // Try to get values using dynamic ID system\n      const itemNumber = getLineItemValue(index, 'itemNumber', '-');\n      const description = getLineItemValue(index, 'description', '-');\n      const quantity = getLineItemValue(index, 'quantity', '-');\n      const unitPrice = getLineItemValue(index, 'unitPrice', '-');\n      const total = getLineItemValue(index, 'total', '-');\n      return `\n        <tr data-row-id=\"line-item-${index}\" data-row-index=\"${index}\">\n            <td class=\"item-cell\" align=\"left\" colspan=\"3\" data-field=\"itemNumber\" data-row=\"${index}\">${itemNumber}</td>\n            <td class=\"item-cell\" align=\"left\" colspan=\"12\" data-field=\"description\" data-row=\"${index}\">${description}</td>\n            <td class=\"item-cell\" align=\"center\" colspan=\"2\" data-field=\"quantity\" data-row=\"${index}\">${quantity}</td>\n            <td class=\"item-cell\" align=\"right\" colspan=\"3\" data-field=\"unitPrice\" data-row=\"${index}\">${unitPrice}</td>\n            <td class=\"item-cell\" align=\"right\" colspan=\"3\" data-field=\"total\" data-row=\"${index}\">${total}</td>\n        </tr>`;\n    }).join('');\n  };\n\n  // Generate the complete XML using the new template structure\n  const xml = `<?xml version=\"1.0\"?>\n<!DOCTYPE pdf PUBLIC \"-//big.faceless.org//report\" \"report-1.1.dtd\">\n<pdf>\n<head>\n    <meta name=\"title\" value=\"Purchase Order\"/>\n    <meta name=\"author\" value=\"Purchase Order Generator\"/>\n    <meta name=\"subject\" value=\"Purchase Order\"/>\n    <meta name=\"creator\" value=\"Purchase Order Generator\"/>\n    <meta name=\"producer\" value=\"Purchase Order Generator\"/>\n    <meta name=\"creationDate\" value=\"${new Date().toISOString()}\"/>\n    <!-- Header Color Configuration -->\n    <!-- Generated at: ${new Date().toISOString()} -->\n    <!-- Header Background: ${headerColors.headerBackground} -->\n    <!-- Header Text: ${headerColors.headerText} -->\n    <!-- Header Border: ${headerColors.headerBorder} -->\n    <!-- Section Title Background: ${headerColors.sectionTitleBackground} -->\n    <!-- Section Title Text: ${headerColors.sectionTitleText} -->\n    <!-- All section headers (Purchase Order, Comments, Vendor, Ship To, etc.) now use section title colors -->\n    \n    <meta name=\"modDate\" value=\"${new Date().toISOString()}\"/>\n    <link name=\"NotoSans\" type=\"font\" subtype=\"truetype\" src=\"\\${nsfont.NotoSans_Regular}\" src-bold=\"\\${nsfont.NotoSans_Bold}\" src-italic=\"\\${nsfont.NotoSans_Italic}\" src-bolditalic=\"\\${nsfont.NotoSans_BoldItalic}\" bytes=\"2\" />\n    <style>\n        * { font-family: NotoSans, sans-serif; font-size: 9pt; }\n        table { width: 100%; border-collapse: collapse; }\n        .header-company { font-size: 14pt; font-weight: bold; }\n        .header-title { font-size: 20pt; font-weight: bold; background-color: ${headerColors.sectionTitleBackground}; color: ${headerColors.sectionTitleText}; padding: 6px; border: 1px solid #000; }\n        .header-info { font-size: 10pt; }\n        .section-header { background-color: ${headerColors.sectionTitleBackground}; color: ${headerColors.sectionTitleText}; font-weight: bold; padding: 6px; border: 1px solid #000; }\n        .section-content { padding: 6px; border: 1px solid #000; vertical-align: top; }\n        .item-header { background-color: ${headerColors.sectionTitleBackground}; color: ${headerColors.sectionTitleText}; font-weight: bold; padding: 8px; border: 1px solid #000; }\n        .item-cell { padding: 6px; border: 1px solid #000; }\n        .total-label { font-weight: bold; padding: 4px; }\n        .total-amount { font-weight: bold; padding: 4px; background-color: #ffff99; }\n        .comments-header { background-color: ${headerColors.sectionTitleBackground}; color: ${headerColors.sectionTitleText}; font-weight: bold; padding: 6px; border: 1px solid #000; }\n        .comments-content { padding: 6px; border: 1px solid #000; min-height: 40px; }\n        .contact-info { font-size: 8pt; }\n        \n        /* All section headers now use section title colors */\n        .section-header, .header-title, .comments-header, .item-header {\n            background-color: ${headerColors.sectionTitleBackground} !important;\n            color: ${headerColors.sectionTitleText} !important;\n        }\n    </style>\n</head>\n<body padding=\"0.5in\" size=\"Letter\">\n    \n    ${buildHeaderSectionXML()}\n    ${buildVendorShipToAndShippingDetailsXML()}\n\n\n    ${buildLineItemsXML()}\n\n\n    ${buildCommentsTotalsXML()}\n\n\n\n    <table style=\"margin-top: 20px;\" data-section=\"contact-signature\">\n        <tr>\n            ${buildContactXML()}\n            <td style=\"width: 30%; text-align: center;\" data-field=\"signature\">\n                <table style=\"width: 100%;\">\n                    <tr>\n                        <td style=\"border-top: 1px solid #000; padding-top: 10px;\">\n                            Authorized Signature\n                        </td>\n                    </tr>\n                </table>\n            </td>\n        </tr>\n    </table>\n</body>\n</pdf>`;\n  console.log('✅ DYNAMIC ID TEMPLATE: XML generated successfully with dynamic field support');\n  console.log('📄 XML preview (first 200 chars):', xml.substring(0, 200));\n  return xml;\n}\n\n// Export the template structure for reference with dynamic ID support\nexport const purchaseOrderTemplate = {\n  companyInfo: {\n    staticFields: ['company-name', 'company-address', 'company-city-state', 'company-phone', 'company-fax', 'company-website'],\n    dynamicPrefixes: ['company-field-', 'company-'],\n    dataAttribute: 'data-section=\"company-info\"'\n  },\n  purchaseOrder: {\n    staticFields: ['po-title', 'po-date', 'po-number'],\n    dynamicPrefixes: ['po-field-', 'po-'],\n    dataAttribute: 'data-section=\"purchase-order-info\"'\n  },\n  vendor: {\n    staticFields: ['vendor-company', 'vendor-contact', 'vendor-address', 'vendor-city-state', 'vendor-phone', 'vendor-fax'],\n    dynamicPrefixes: ['vendor-field-', 'vendor-'],\n    dataAttribute: 'data-subsection=\"vendor\"'\n  },\n  shipTo: {\n    staticFields: ['ship-to-name', 'ship-to-company', 'ship-to-address', 'ship-to-city-state', 'ship-to-phone', 'ship-to-fax'],\n    dynamicPrefixes: ['ship-to-field-', 'ship-to-'],\n    dataAttribute: 'data-subsection=\"ship-to\"'\n  },\n  shipping: {\n    staticFields: ['requisitioner', 'shipVia', 'fob', 'shippingTerms'],\n    dynamicPrefixes: ['shipping-field-', 'shipping-'],\n    dataAttribute: 'data-section=\"shipping-details\"'\n  },\n  lineItems: {\n    staticFields: ['itemNumber', 'description', 'quantity', 'unitPrice', 'total'],\n    dynamicPrefixes: ['line-item-', 'item-'],\n    dataAttribute: 'data-section=\"line-items\"',\n    maxRows: 5\n  },\n  totals: {\n    staticFields: ['subtotal', 'tax', 'shipping', 'other', 'total'],\n    dynamicPrefixes: ['total-', 'totals-'],\n    dataAttribute: 'data-subsection=\"totals\"'\n  },\n  comments: {\n    staticFields: ['comments'],\n    dynamicPrefixes: ['comments-field-', 'comment-'],\n    dataAttribute: 'data-subsection=\"comments\"'\n  },\n  contact: {\n    staticFields: ['contactInfo'],\n    dynamicPrefixes: ['contact-info-field-', 'contact-'],\n    dataAttribute: 'data-section=\"contact-signature\"'\n  }\n};\n\n// Export a simple function to get template structure\nexport function getTemplateStructure() {\n  return purchaseOrderTemplate;\n}\n\n// Dynamic ID Generation Utilities\nexport const dynamicIdUtils = {\n  // Generate a new dynamic ID with timestamp and random component\n  generateId: (prefix = 'field', section = 'general') => {\n    const timestamp = Date.now();\n    const random = Math.random().toString(36).substr(2, 9);\n    return `${section}-${prefix}-${timestamp}-${random}`;\n  },\n  // Generate multiple possible IDs for a field to try when looking up values\n  getPossibleIds: (staticId, section = 'unknown') => {\n    const baseName = staticId.replace(/^(company-|po-|vendor-|ship-to-)/, '');\n    return [staticId,\n    // Try static ID first\n    `${section}-field-${staticId}`, `${section}-${baseName}`, `${staticId}-${Date.now()}`, `field-${baseName}`, baseName];\n  },\n  // Validate if an ID follows our dynamic ID pattern\n  isValidDynamicId: id => {\n    const dynamicPattern = /^[a-z-]+-(field-)?[a-z-]+(-\\d+)?(-[a-z0-9]+)?$/;\n    return dynamicPattern.test(id);\n  },\n  // Extract the base field type from any ID (static or dynamic)\n  getFieldType: id => {\n    // Remove common prefixes and suffixes to get the core field type\n    return id.replace(/^(company-|po-|vendor-|ship-to-|shipping-|total-|line-item-|comments-|contact-)/, '').replace(/-(field-)?(\\d+)?(-[a-z0-9]+)?$/, '').replace(/^(field-)?/, '');\n  },\n  // Get section from ID\n  getSection: id => {\n    if (id.startsWith('company-')) return 'company';\n    if (id.startsWith('po-')) return 'purchase-order';\n    if (id.startsWith('vendor-')) return 'vendor';\n    if (id.startsWith('ship-to-')) return 'ship-to';\n    if (id.startsWith('shipping-')) return 'shipping';\n    if (id.startsWith('line-item-')) return 'line-items';\n    if (id.startsWith('total-')) return 'totals';\n    if (id.startsWith('comments-')) return 'comments';\n    if (id.startsWith('contact-')) return 'contact';\n    return 'unknown';\n  }\n};\n\n// Field Mapping Utilities\nexport const fieldMappingUtils = {\n  // Map all known static field IDs to their readable names\n  staticFieldNames: {\n    // Company fields\n    'company-name': 'Company Name',\n    'company-address': 'Street Address',\n    'company-city-state': 'City, State, ZIP',\n    'company-phone': 'Phone Number',\n    'company-fax': 'Fax Number',\n    'company-website': 'Website',\n    // Purchase Order fields\n    'po-title': 'Purchase Order Title',\n    'po-date': 'Date',\n    'po-number': 'PO Number',\n    // Vendor fields\n    'vendor-company': 'Vendor Company',\n    'vendor-contact': 'Vendor Contact',\n    'vendor-address': 'Vendor Address',\n    'vendor-city-state': 'Vendor City/State',\n    'vendor-phone': 'Vendor Phone',\n    'vendor-fax': 'Vendor Fax',\n    // Ship To fields\n    'ship-to-name': 'Ship To Name',\n    'ship-to-company': 'Ship To Company',\n    'ship-to-address': 'Ship To Address',\n    'ship-to-city-state': 'Ship To City/State',\n    'ship-to-phone': 'Ship To Phone',\n    'ship-to-fax': 'Ship To Fax',\n    // Shipping fields\n    'requisitioner': 'Requisitioner',\n    'shipVia': 'Ship Via',\n    'fob': 'F.O.B.',\n    'shippingTerms': 'Shipping Terms',\n    // Line item fields\n    'itemNumber': 'Item Number',\n    'description': 'Description',\n    'quantity': 'Quantity',\n    'unitPrice': 'Unit Price',\n    'total': 'Total',\n    // Totals fields\n    'subtotal': 'Subtotal',\n    'tax': 'Tax',\n    'shipping': 'Shipping',\n    'other': 'Other',\n    // Other fields\n    'comments': 'Comments',\n    'contactInfo': 'Contact Information'\n  },\n  // Get human-readable name for any field ID\n  getFieldName: id => {\n    const staticName = fieldMappingUtils.staticFieldNames[id];\n    if (staticName) return staticName;\n\n    // For dynamic IDs, try to extract the base field type\n    const fieldType = dynamicIdUtils.getFieldType(id);\n    const staticFieldName = fieldMappingUtils.staticFieldNames[fieldType];\n    if (staticFieldName) return staticFieldName;\n\n    // Fallback: humanize the ID\n    return id.replace(/[-_]/g, ' ').replace(/\\b\\w/g, l => l.toUpperCase());\n  },\n  // Get all field IDs for a section\n  getFieldsForSection: section => {\n    const template = purchaseOrderTemplate[section];\n    return template ? template.staticFields : [];\n  }\n};","map":{"version":3,"names":["processFormData","getHeaderColors","root","document","documentElement","computedStyle","getComputedStyle","headerBackground","getPropertyValue","trim","headerText","headerBorder","sectionTitleBackground","sectionTitleText","generatePurchaseOrderXML","formData","options","_fieldOrderData$compa","_fieldOrderData$purch","_formData$companyFiel","_data$companyFields","_fieldOrderData$compa2","_fieldOrderData$compa3","console","log","Date","toISOString","headerColors","processedData","calculateTotals","validate","formatForXML","throwOnValidationError","error","data","Array","isArray","lineItems","map","row","_ref","_row$quantity","_ref2","_row$unitPrice","_ref3","_row$total","_row$qty","_row$rate","_row$amount","_row$quantity2","_row$unitPrice2","_row$total2","quantity","qty","unitPrice","rate","total","amount","String","Number","replace","fieldOrderData","companyFields","purchaseOrderFields","vendorFields","shipToFields","f","id","label","length","warn","getFieldValue","fieldName","defaultValue","getDynamicFieldValue","fieldArray","possibleIds","fieldId","field","find","value","getCompanyFieldValue","staticId","now","filter","includes","getPOFieldValue","getVendorFieldValue","getShipToFieldValue","getTotalsFieldValue","totalsFields","formatFieldWithLabel","rawValue","toString","labelText","lowered","toLowerCase","loweredLabel","startsWith","buildCompanyXML","position","_data$fieldOrder","_data$sectionOrder","fieldOrder","company","sectionOrder","sections1And2","indexOf","orderedCompanyFields","Boolean","fieldRows","index","fieldValue","placeholder","isHeader","displayText","join","companyTdPadding","result","buildCompanyNetSuiteXML","_data$fieldOrder2","netSuiteFieldMapping","netSuiteVariable","cleanId","needsLabel","buildPurchaseOrderXML","_data$fieldOrder3","purchaseOrder","orderedPOFields","isTitle","genericValue","poTdPadding","buildVendorShipToSectionXML","_data$sectionOrder2","_data$sectionOrder3","sections3And4","leftSection","rightSection","leftColumn","rightColumn","buildVendorXML","buildShipToXML","buildShippingDetailsXML","_data$sectionOrder4","shippingColumnOrder","shippingColumns","columnConfig","requisitioner","shipVia","fob","shippingTerms","getColumnConfig","columnId","toUpperCase","headerCells","config","contentCells","getShippingFieldValue","buildVendorShipToAndShippingDetailsXML","majorSectionsOrder","topSection","bottomSection","topContent","bottomContent","buildHeaderSectionXML","_data$sectionOrder5","_data$sectionOrder6","_data$sectionOrder7","_data$sectionOrder8","_data$sectionOrder8$s","_data$sectionOrder9","_fieldOrderData$compa4","_fieldOrderData$purch2","Object","keys","JSON","stringify","_data$fieldOrder4","vendorFieldOrder","vendor","orderedVendorFields","rows","raw","display","_data$fieldOrder5","shipToFieldOrder","shipTo","orderedShipToFields","buildVendorShipToXML","_data$sectionOrder0","buildLineItemsXML","_data$sectionOrder1","_data$sectionOrder10","columnOrder","lineItemColumns","itemNumber","colSpan","description","headerRow","customType","split","charAt","slice","actualRowCount","dataRows","rowData","rowIndex","rowCells","undefined","buildCommentsXML","commentsFieldsOrder","commentsFields","getCommentsFieldValue","element","querySelector","textContent","commentsRows","buildContactXML","contactFieldsOrder","contactFields","getContactFieldValue","contactRows","buildTotalsXML","totalsFieldsOrder","totalsRows","buildCommentsTotalsXML","_data$sectionOrder11","sections8And9","fieldType","possibleSelectors","selector","getLineItemValue","colIdMap","colId","getColumnIndex","text","debug","found","columnMap","getTotalFieldValue","getCommentsValue","comments","getContactInfoValue","contactInfo","generateLineItemsXML","maxRows","fill","_","xml","substring","purchaseOrderTemplate","companyInfo","staticFields","dynamicPrefixes","dataAttribute","shipping","totals","contact","getTemplateStructure","dynamicIdUtils","generateId","prefix","section","timestamp","random","Math","substr","getPossibleIds","baseName","isValidDynamicId","dynamicPattern","test","getFieldType","getSection","fieldMappingUtils","staticFieldNames","getFieldName","staticName","staticFieldName","l","getFieldsForSection","template"],"sources":["/Users/waleed/Documents/GitHub/Cadbury3/src/templates/PurchaseOrderTemplate.js"],"sourcesContent":["// Purchase Order XML Template for NetSuite Integration\n// This template generates XML compatible with Big Faceless Report Generator (BFR)\n\nimport { processFormData } from './FormDataMapper';\n\n// Function to get current header colors from CSS variables\nfunction getHeaderColors() {\n  const root = document.documentElement;\n  const computedStyle = getComputedStyle(root);\n  \n  return {\n    headerBackground: computedStyle.getPropertyValue('--header-background').trim() || '#000000',\n    headerText: computedStyle.getPropertyValue('--header-text').trim() || '#ffffff',\n    headerBorder: computedStyle.getPropertyValue('--header-border').trim() || 'rgba(255, 255, 255, 0.3)',\n    sectionTitleBackground: computedStyle.getPropertyValue('--section-title-background').trim() || '#f8fafc',\n    sectionTitleText: computedStyle.getPropertyValue('--section-title-text').trim() || '#374151'\n  };\n}\n\n// Function to generate XML from React form data\nexport function generatePurchaseOrderXML(formData, options = {}) {\n  // DEBUG: Log that we're using the DYNAMIC ID template\n  console.log('🚀 DYNAMIC ID TEMPLATE VERSION LOADED - generatePurchaseOrderXML called');\n  console.log('📅 Template updated at:', new Date().toISOString());\n  console.log('📊 Raw form data received:', formData);\n  \n  // Get current header colors for XML generation\n  const headerColors = getHeaderColors();\n  console.log('🎨 Current header colors:', headerColors);\n  \n  // Process and validate form data using the FormDataMapper\n  let processedData;\n  try {\n    processedData = processFormData(formData, {\n      calculateTotals: options.calculateTotals !== false,\n      validate: options.validate !== false,\n      formatForXML: true,\n      throwOnValidationError: options.throwOnValidationError || false\n    });\n    console.log('📊 Processed form data:', processedData);\n  } catch (error) {\n    console.error('❌ Form data processing failed:', error);\n    if (options.throwOnValidationError) {\n      throw error;\n    }\n    // Fallback to using raw data\n    processedData = formData || {};\n  }\n  \n  // Merge processed data with original so ad-hoc fields (totals, shipping, UI line item keys) survive\n  // Prefer original ad-hoc keys when present (they reflect the live DOM at export time)\n  const data = {\n    ...(processedData || {}),\n    ...(formData || {})\n  };\n\n  // Normalize line items to expose both key styles expected by template rendering\n  if (Array.isArray(data.lineItems)) {\n    data.lineItems = data.lineItems.map((row) => {\n      const quantity = row.quantity ?? row.qty ?? '';\n      const unitPrice = row.unitPrice ?? row.rate ?? '';\n      const total = row.total ?? row.amount ?? '';\n      return {\n        ...row,\n        qty: row.qty ?? (quantity !== '' ? String(quantity) : ''),\n        rate: row.rate ?? (unitPrice !== '' ? String(unitPrice) : ''),\n        amount: row.amount ?? (total !== '' ? String(total) : ''),\n        quantity: row.quantity ?? (quantity !== '' ? Number(String(quantity).replace(/[$,]/g, '')) : 0),\n        unitPrice: row.unitPrice ?? (unitPrice !== '' ? Number(String(unitPrice).replace(/[$,]/g, '')) : 0),\n        total: row.total ?? (total !== '' ? Number(String(total).replace(/[$,]/g, '')) : 0)\n      };\n    });\n  }\n  \n  // IMPORTANT: For field ordering, use the original formData to preserve drag-and-drop order\n  const fieldOrderData = {\n    ...data,\n    companyFields: formData.companyFields || data.companyFields || [],\n    purchaseOrderFields: formData.purchaseOrderFields || data.purchaseOrderFields || [],\n    vendorFields: formData.vendorFields || data.vendorFields || [],\n    shipToFields: formData.shipToFields || data.shipToFields || []\n  };\n  \n  // DEBUG: Log field order data creation\n  console.log('🔍 DEBUG: fieldOrderData created with:');\n  console.log('🔍 DEBUG: - companyFields:', fieldOrderData.companyFields?.map(f => ({ id: f.id, label: f.label })));\n  console.log('🔍 DEBUG: - purchaseOrderFields:', fieldOrderData.purchaseOrderFields?.map(f => ({ id: f.id, label: f.label })));\n  console.log('🔍 DEBUG: - formData.companyFields:', formData.companyFields?.map(f => ({ id: f.id, label: f.label })));\n  console.log('🔍 DEBUG: - data.companyFields:', data.companyFields?.map(f => ({ id: f.id, label: f.label })));\n  \n  // VALIDATION: Ensure field order data is robust and independent of section order\n  console.log('🔍 DEBUG: Field order data validation:');\n  console.log('🔍 DEBUG: - fieldOrderData.companyFields length:', fieldOrderData.companyFields?.length);\n  console.log('🔍 DEBUG: - fieldOrderData.companyFields is array:', Array.isArray(fieldOrderData.companyFields));\n  console.log('🔍 DEBUG: - fieldOrderData.companyFields IDs:', fieldOrderData.companyFields?.map(f => f.id));\n  \n  // Ensure field order data is always available and valid\n  if (!Array.isArray(fieldOrderData.companyFields) || fieldOrderData.companyFields.length === 0) {\n    console.warn('⚠️ WARNING: companyFields is not available or empty, this may cause field order issues');\n  }\n  \n  // Helper function to safely get field values with fallbacks (for simple fields)\n  const getFieldValue = (fieldName, defaultValue = '') => {\n    return data[fieldName] || defaultValue;\n  };\n\n  // Enhanced helper function to get field values by dynamic ID or static fallback\n  const getDynamicFieldValue = (fieldArray, possibleIds, defaultValue = '') => {\n    if (!fieldArray || !Array.isArray(fieldArray)) {\n      return defaultValue;\n    }\n    \n    // Try each possible ID in order of preference\n    for (const fieldId of possibleIds) {\n      const field = fieldArray.find(f => f.id === fieldId);\n      if (field && field.value) {\n        return field.value;\n      }\n    }\n    return defaultValue;\n  };\n\n  // Helper function to get company field values with dynamic ID support\n  const getCompanyFieldValue = (staticId, defaultValue = '') => {\n    if (data.companyFields && Array.isArray(data.companyFields)) {\n      // First try the static ID, then try dynamic IDs that might have been generated\n      const possibleIds = [\n        staticId,\n        `company-field-${staticId}`,\n        `${staticId}-${Date.now()}`,\n        ...data.companyFields.filter(f => f.id.includes(staticId.replace('company-', ''))).map(f => f.id)\n      ];\n      return getDynamicFieldValue(data.companyFields, possibleIds, defaultValue);\n    }\n    return defaultValue;\n  };\n\n  // Helper function to get purchase order field values with dynamic ID support\n  const getPOFieldValue = (staticId, defaultValue = '') => {\n    if (data.purchaseOrderFields && Array.isArray(data.purchaseOrderFields)) {\n      const possibleIds = [\n        staticId,\n        `po-field-${staticId}`,\n        `${staticId}-${Date.now()}`,\n        ...data.purchaseOrderFields.filter(f => f.id.includes(staticId.replace('po-', ''))).map(f => f.id)\n      ];\n      return getDynamicFieldValue(data.purchaseOrderFields, possibleIds, defaultValue);\n    }\n    return defaultValue;\n  };\n\n  // Helper function to get vendor field values with dynamic ID support\n  const getVendorFieldValue = (staticId, defaultValue = '') => {\n    if (data.vendorFields && Array.isArray(data.vendorFields)) {\n      const possibleIds = [\n        staticId,\n        `vendor-field-${staticId}`,\n        `${staticId}-${Date.now()}`,\n        ...data.vendorFields.filter(f => f.id.includes(staticId.replace('vendor-', ''))).map(f => f.id)\n      ];\n      return getDynamicFieldValue(data.vendorFields, possibleIds, defaultValue);\n    }\n    return defaultValue;\n  };\n\n  // Helper function to get ship-to field values with dynamic ID support\n  const getShipToFieldValue = (staticId, defaultValue = '') => {\n    if (data.shipToFields && Array.isArray(data.shipToFields)) {\n      const possibleIds = [\n        staticId,\n        `ship-to-field-${staticId}`,\n        `${staticId}-${Date.now()}`,\n        ...data.shipToFields.filter(f => f.id.includes(staticId.replace('ship-to-', ''))).map(f => f.id)\n      ];\n      return getDynamicFieldValue(data.shipToFields, possibleIds, defaultValue);\n    }\n    return defaultValue;\n  };\n\n  // Helper function to get totals field values with dynamic ID support\n  const getTotalsFieldValue = (staticId, defaultValue = '') => {\n    if (data.totalsFields && Array.isArray(data.totalsFields)) {\n      const possibleIds = [\n        staticId,\n        `totals-field-${staticId}`,\n        `${staticId}-${Date.now()}`,\n        ...data.totalsFields.filter(f => f.id.includes(staticId)).map(f => f.id)\n      ];\n      return getDynamicFieldValue(data.totalsFields, possibleIds, defaultValue);\n    }\n    return defaultValue;\n  };\n\n  // --------------------------------------------------------------------------\n  // Generic label+value formatter for dynamic fields across sections\n  // Ensures fields like \"Tax ID Number\" render as \"Tax ID Number: 123...\"\n  // Avoids double-prefixing when the value already starts with the label/prefix\n  const formatFieldWithLabel = (field, rawValue) => {\n    const value = (rawValue ?? '').toString();\n    const labelText = (field?.label || field?.id || '').toString().replace(/:\\s*$/, '').trim();\n    if (!labelText) return value;\n    // If value already starts with the label or a known prefix, don't double prefix\n    const lowered = value.toLowerCase();\n    const loweredLabel = labelText.toLowerCase();\n    if (lowered.startsWith(`${loweredLabel}:`) || lowered.startsWith('phone:') || lowered.startsWith('fax:') || lowered.startsWith('website:')) {\n      return value || labelText; // if empty, show just label\n    }\n    if (!value) return labelText; // show label alone if no value\n    return `${labelText}: ${value}`;\n  };\n\n  // ============================================================================\n  // MODULAR XML BUILDER FUNCTIONS\n  // ============================================================================\n  \n  // Build Company Information XML with dynamic field ordering (same pattern as section swapping)\n  \n  const buildCompanyXML = (position = 'left') => {\n    // Get company fields from fieldOrderData to preserve drag-and-drop order\n    const companyFields = fieldOrderData.companyFields || [];\n    \n    // CRITICAL: Get field order from data (same pattern as section order)\n    const fieldOrder = data.fieldOrder?.company || companyFields.map(f => f.id);\n    \n    console.log('🔀 Building company XML with dynamic field ordering');\n    console.log('🔀 Company fields received from data:', companyFields.length);\n    console.log('🔀 Company fields IDs in current order:', companyFields.map(f => f.id));\n    console.log('🔀 Company fields labels in current order:', companyFields.map(f => f.label));\n    console.log('🔀 Company fields values in current order:', companyFields.map(f => f.value));\n    console.log('🔀 Field order from data:', fieldOrder);\n    \n    // CRITICAL: Ensure field order is completely independent of section order\n    // The field order should be preserved exactly as it appears in fieldOrderData.companyFields\n    // regardless of whether this section is on the left or right\n    console.log('🔍 DEBUG: Field order independence verification:');\n    console.log('🔍 DEBUG: - Current section order:', data.sectionOrder?.sections1And2);\n    console.log('🔍 DEBUG: - Company fields order (should be independent):', companyFields.map(f => ({ id: f.id, label: f.label, position: companyFields.indexOf(f) })));\n    \n    // CRITICAL: Reorder fields based on fieldOrder (same pattern as section swapping)\n    const orderedCompanyFields = fieldOrder.map(fieldId => {\n      const field = companyFields.find(f => f.id === fieldId);\n      if (!field) {\n        console.warn(`⚠️ WARNING: Field with ID ${fieldId} not found in companyFields`);\n        return null;\n      }\n      return field;\n    }).filter(Boolean); // Remove any null fields\n    \n    console.log('🔀 Ordered company fields for XML generation:', orderedCompanyFields.map(f => ({ id: f.id, label: f.label, position: orderedCompanyFields.indexOf(f) })));\n    \n    // Build rows dynamically based on ordered field order (same as section swapping)\n    const fieldRows = orderedCompanyFields.map((field, index) => {\n      const fieldValue = field.value || field.placeholder || '';\n      const isHeader = field.id === 'company-name';\n      \n      console.log(`🔀 Processing field ${index}:`, { id: field.id, label: field.label, value: fieldValue, isHeader, position: index });\n      \n      if (isHeader) {\n        const row = `<tr><td class=\"header-company\" style=\"text-align: left;\" data-field=\"${field.id}\">${fieldValue}</td></tr>`;\n        console.log(`🔀 Generated header row for ${field.id}:`, row);\n        return row;\n      } else {\n        // Prefix generic dynamic fields with their label (except known special cases handled by formatter)\n        const displayText = formatFieldWithLabel(field, fieldValue);\n        const row = `<tr><td style=\"text-align: left;\" data-field=\"${field.id}\">${displayText}</td></tr>`;\n        console.log(`🔀 Generated regular row for ${field.id}:`, row);\n        return row;\n      }\n    }).join('');\n    \n    console.log('🔀 Final generated fieldRows:', fieldRows);\n    \n    // Side-aware padding to keep spacing consistent when swapped\n    const companyTdPadding = position === 'left' ? 'padding-right: 24px;' : 'padding-left: 36px;';\n    const result = `\n      <td style=\"width: 65%; ${companyTdPadding}\" data-section=\"company-info\">\n        <table>\n          ${fieldRows}\n        </table>\n      </td>\n    `;\n    \n    console.log('🔀 Final company XML result:', result);\n    return result;\n  };\n\n  // Build Company Information XML with NetSuite variables (FreeMarker syntax)\n  const buildCompanyNetSuiteXML = (position = 'left') => {\n    // Get company fields from fieldOrderData to preserve drag-and-drop order\n    const companyFields = fieldOrderData.companyFields || [];\n    \n    // Field mapping from form field IDs to NetSuite variables\n    const netSuiteFieldMapping = {\n      'company-name': '${companyInformation.companyName}',\n      'company-address': '${companyInformation.addressText}',\n      'company-phone': '${companyInformation.phone}',\n      'company-fax': '${companyInformation.fax}',\n      'company-email': '${companyInformation.email}',\n      'company-website': '${companyInformation.website}',\n      'company-tax-id': '${companyInformation.taxId}',\n      'company-duns': '${companyInformation.dunsNumber}',\n      'company-business-license': '${companyInformation.businessLicense}',\n      'company-registration': '${companyInformation.registrationNumber}'\n    };\n    \n    // CRITICAL: Get field order from data (same pattern as section order)\n    const fieldOrder = data.fieldOrder?.company || companyFields.map(f => f.id);\n    \n    console.log('🔀 Building NetSuite company XML with dynamic field ordering');\n    console.log('🔀 Company fields received from data:', companyFields.length);\n    console.log('🔀 Field order from data:', fieldOrder);\n    \n    // CRITICAL: Reorder fields based on fieldOrder\n    const orderedCompanyFields = fieldOrder.map(fieldId => {\n      const field = companyFields.find(f => f.id === fieldId);\n      if (!field) {\n        console.warn(`⚠️ WARNING: Field with ID ${fieldId} not found in companyFields`);\n        return null;\n      }\n      return field;\n    }).filter(Boolean);\n    \n    console.log('🔀 Ordered company fields for NetSuite XML generation:', orderedCompanyFields.map(f => ({ id: f.id, label: f.label })));\n    \n    // Build rows with NetSuite variables instead of hardcoded values\n    const fieldRows = orderedCompanyFields.map((field, index) => {\n      const isHeader = field.id === 'company-name';\n      \n      // Get NetSuite variable for this field, or create a generic one\n      let netSuiteVariable = netSuiteFieldMapping[field.id];\n      \n      if (!netSuiteVariable) {\n        // For dynamic fields, create a generic NetSuite variable\n        const cleanId = field.id.replace(/^company-/, '').replace(/-/g, '');\n        netSuiteVariable = `\\${companyInformation.${cleanId}}`;\n        console.log(`🔀 Generated dynamic NetSuite variable for ${field.id}: ${netSuiteVariable}`);\n      }\n      \n      console.log(`🔀 Processing NetSuite field ${index}:`, { \n        id: field.id, \n        label: field.label, \n        netSuiteVariable, \n        isHeader, \n        position: index \n      });\n      \n      if (isHeader) {\n        const row = `<tr><td class=\"header-company\" style=\"text-align: left;\" data-field=\"${field.id}\">${netSuiteVariable}</td></tr>`;\n        console.log(`🔀 Generated NetSuite header row for ${field.id}:`, row);\n        return row;\n      } else {\n        // For non-header fields, include label if it's not already in the NetSuite variable\n        const needsLabel = !['${companyInformation.addressText}', '${companyInformation.phone}', '${companyInformation.email}'].includes(netSuiteVariable);\n        const displayText = needsLabel ? `${field.label}: ${netSuiteVariable}` : netSuiteVariable;\n        const row = `<tr><td style=\"text-align: left;\" data-field=\"${field.id}\">${displayText}</td></tr>`;\n        console.log(`🔀 Generated NetSuite regular row for ${field.id}:`, row);\n        return row;\n      }\n    }).join('');\n    \n    console.log('🔀 Final generated NetSuite fieldRows:', fieldRows);\n    \n    // Side-aware padding to keep spacing consistent when swapped\n    const companyTdPadding = position === 'left' ? 'padding-right: 24px;' : 'padding-left: 36px;';\n    const result = `\n      <td style=\"width: 65%; ${companyTdPadding}\" data-section=\"company-info\">\n        <table>\n          ${fieldRows}\n        </table>\n      </td>\n    `;\n    \n    console.log('🔀 Final NetSuite company XML result:', result);\n    return result;\n  };\n\n  // Build Purchase Order Information XML\n  const buildPurchaseOrderXML = (position = 'right') => {\n    // Get purchase order fields from fieldOrderData to preserve drag-and-drop order\n    const purchaseOrderFields = fieldOrderData.purchaseOrderFields || [];\n    \n    // CRITICAL: Get field order from data (same pattern as section order)\n    const fieldOrder = data.fieldOrder?.purchaseOrder || purchaseOrderFields.map(f => f.id);\n    \n    console.log('🔀 Building purchase order XML with dynamic field ordering');\n    console.log('🔀 Purchase order fields received from data:', purchaseOrderFields.length);\n    console.log('🔀 Purchase order fields IDs in current order:', purchaseOrderFields.map(f => f.id));\n    console.log('🔀 Field order from data:', fieldOrder);\n    \n    // CRITICAL: Reorder fields based on fieldOrder (same pattern as section swapping)\n    const orderedPOFields = fieldOrder.map(fieldId => {\n      const field = purchaseOrderFields.find(f => f.id === fieldId);\n      if (!field) {\n        console.warn(`⚠️ WARNING: Field with ID ${fieldId} not found in purchaseOrderFields`);\n        return null;\n      }\n      return field;\n    }).filter(Boolean); // Remove any null fields\n    \n    console.log('🔀 Ordered purchase order fields for XML generation:', orderedPOFields.map(f => ({ id: f.id, label: f.label, position: orderedPOFields.indexOf(f) })));\n    \n    // Build XML based on ordered fields\n    const fieldRows = orderedPOFields.map((field, index) => {\n      // Prefer captured value; fallback to template getters to ensure content always present\n      const isTitle = field.id === 'po-title';\n      if (isTitle) {\n        const value = field.value || getPOFieldValue('po-title', 'PURCHASE ORDER');\n        return `<tr><td class=\"header-title\" style=\"text-align: right;\" data-field=\"${field.id}\">${value}</td></tr>`;\n      }\n      if (field.id === 'po-date') {\n        const value = field.value || getPOFieldValue('po-date', 'MM/DD/YYYY');\n        return `<tr><td style=\"text-align: right;\"><table style=\"width: 100%;\"><tr><td class=\"header-info\" style=\"width: 30%; text-align: left;\"><b>DATE</b></td><td class=\"header-info\" style=\"width: 70%; text-align: left;\" data-field=\"po-date\">${value}</td></tr></table></td></tr>`;\n      }\n      if (field.id === 'po-number') {\n        const value = field.value || getPOFieldValue('po-number', '[PO Number]');\n        return `<tr><td style=\"text-align: right;\"><table style=\"width: 100%;\"><tr><td class=\"header-info\" style=\"width: 30%; text-align: left;\"><b>PO #</b></td><td class=\"header-info\" style=\"width: 70%; text-align: left;\" data-field=\"po-number\">${value}</td></tr></table></td></tr>`;\n      }\n      \n      const genericValue = field.value || getPOFieldValue(field.id, '');\n      const displayText = formatFieldWithLabel(field, genericValue);\n      return `<tr><td style=\"text-align: right;\" data-field=\"${field.id}\">${displayText}</td></tr>`;\n    }).join('');\n    \n    // Side-aware padding: when PO is on the left, push it away from the right column\n    const poTdPadding = position === 'left' ? 'padding-right: 56px;' : 'padding-left: 28px;';\n    return `\n      <td style=\"width: 35%; ${poTdPadding}\" align=\"right\" data-section=\"purchase-order-info\">\n        <table>\n          ${fieldRows}\n        </table>\n      </td>\n    `;\n  };\n\n\n\n  // Build Vendor-ShipTo Section XML with dynamic ordering\n  const buildVendorShipToSectionXML = () => {\n    // Get section order from data, default to [section3, section4] if not provided\n    const sectionOrder = data.sectionOrder?.sections3And4 || ['section3', 'section4'];\n    const leftSection = sectionOrder[0];\n    const rightSection = sectionOrder[1];\n    \n    console.log('🔀 Building vendor-shipTo section with order:', { leftSection, rightSection });\n    console.log('🔀 sections3And4 array:', data.sectionOrder?.sections3And4);\n    \n    let leftColumn, rightColumn;\n    \n    if (leftSection === 'section3') {\n      // Default order: Vendor left, Ship To right\n      leftColumn = buildVendorXML();\n      rightColumn = buildShipToXML();\n      console.log('🔀 Using default order: Vendor left, Ship To right');\n    } else {\n      // Swapped order: Ship To left, Vendor right\n      leftColumn = buildShipToXML();\n      rightColumn = buildVendorXML();\n      console.log('🔀 Using swapped order: Ship To left, Vendor right');\n    }\n    \n    return `\n      <table style=\"margin-top: 20px;\" data-section=\"vendor-ship-to\">\n        <tr>\n          ${leftColumn}\n          ${rightColumn}\n        </tr>\n      </table>\n    `;\n  };\n\n  // Build Shipping Details XML with dynamic column ordering\n  const buildShippingDetailsXML = () => {\n    // Get shipping column order from data, default to standard order if not provided\n    const shippingColumnOrder = data.sectionOrder?.shippingColumns || ['requisitioner', 'shipVia', 'fob', 'shippingTerms'];\n    \n    console.log('🔀 Building shipping details with column order:', shippingColumnOrder);\n    \n    // Column configuration mapping\n    const columnConfig = {\n      requisitioner: { label: 'REQUISITIONER', field: 'requisitioner' },\n      shipVia: { label: 'SHIP VIA', field: 'shipVia' },\n      fob: { label: 'F.O.B.', field: 'fob' },\n      shippingTerms: { label: 'SHIPPING TERMS', field: 'shippingTerms' }\n    };\n    \n    // Helper function to get column configuration (handles custom columns)\n    const getColumnConfig = (columnId) => {\n      // Check if it's a standard column\n      if (columnConfig[columnId]) {\n        return columnConfig[columnId];\n      }\n      \n      // Handle custom columns (those that start with 'custom-')\n      if (columnId.startsWith('custom-')) {\n        return {\n          label: columnId.toUpperCase().replace('custom-', 'CUSTOM '),\n          field: columnId\n        };\n      }\n      \n      // Fallback for unknown columns\n      console.warn(`⚠️ Unknown shipping column: ${columnId}`);\n      return {\n        label: columnId.toUpperCase(),\n        field: columnId\n      };\n    };\n    \n    // Build header row\n    const headerCells = shippingColumnOrder.map(columnId => {\n      const config = getColumnConfig(columnId);\n      return `<td class=\"section-header\" style=\"width: 25%;\">${config.label}</td>`;\n    }).join('');\n    \n    // Build content row\n    const contentCells = shippingColumnOrder.map(columnId => {\n      const config = getColumnConfig(columnId);\n      return `<td class=\"section-content\" data-field=\"${config.field}\">${getShippingFieldValue(config.field, `[${config.label}]`)}</td>`;\n    }).join('');\n    \n    return `\n      <table style=\"margin-top: 15px;\" data-section=\"shipping-details\">\n        <tr>\n          ${headerCells}\n        </tr>\n        <tr>\n          ${contentCells}\n        </tr>\n      </table>\n    `;\n  };\n\n  // Build Vendor-ShipTo AND Shipping Details sections with vertical swapping\n  const buildVendorShipToAndShippingDetailsXML = () => {\n    // Get major sections order from data - this is the new state for group swapping\n    const majorSectionsOrder = data.majorSectionsOrder || ['vendor-shipto-group', 'shipping-section'];\n    const topSection = majorSectionsOrder[0];\n    const bottomSection = majorSectionsOrder[1];\n    \n    console.log('🔀 Building vendor-shipTo + shipping details with majorSectionsOrder:', { topSection, bottomSection });\n    console.log('🔀 majorSectionsOrder array:', data.majorSectionsOrder);\n    \n    let topContent, bottomContent;\n    \n    if (topSection === 'vendor-shipto-group') {\n      // Default order: Vendor-ShipTo group on top, Shipping Details below\n      topContent = buildVendorShipToSectionXML();\n      bottomContent = buildShippingDetailsXML();\n      console.log('🔀 Using default order: Vendor-ShipTo group top, Shipping section bottom');\n    } else {\n      // Swapped order: Shipping Details on top, Vendor-ShipTo group below\n      topContent = buildShippingDetailsXML();\n      bottomContent = buildVendorShipToSectionXML();\n      console.log('🔀 Using swapped order: Shipping section top, Vendor-ShipTo group bottom');\n    }\n    \n    return `\n      ${topContent}\n      ${bottomContent}\n    `;\n  };\n\n  // Build Header Section XML (Company + Purchase Order) with dynamic ordering\n  const buildHeaderSectionXML = () => {\n    // Get section order from data, default to [section1, section2] if not provided\n    const sectionOrder = data.sectionOrder?.sections1And2 || ['section1', 'section2'];\n    const leftSection = sectionOrder[0];\n    const rightSection = sectionOrder[1];\n    \n    console.log('🔀 Building header section with order:', { leftSection, rightSection });\n    console.log('🔀 Full sectionOrder data:', data.sectionOrder);\n    console.log('🔀 Full data object keys:', Object.keys(data));\n    console.log('🔀 sections1And2 array:', data.sectionOrder?.sections1And2);\n    console.log('🔀 sections1And2 type:', typeof data.sectionOrder?.sections1And2);\n    console.log('🔀 sections1And2 length:', data.sectionOrder?.sections1And2?.length);\n    console.log('🔀 sections1And2 values:', JSON.stringify(data.sectionOrder?.sections1And2));\n    \n    // DEBUG: Check field order data when building header\n    console.log('🔍 DEBUG: fieldOrderData.companyFields when building header:', fieldOrderData.companyFields?.map(f => ({ id: f.id, label: f.label })));\n    console.log('🔍 DEBUG: fieldOrderData.purchaseOrderFields when building header:', fieldOrderData.purchaseOrderFields?.map(f => ({ id: f.id, label: f.label })));\n    \n    // IMPORTANT: Field order should be completely independent of section order\n    // Always use the current field order from fieldOrderData, regardless of section position\n    console.log('🔍 DEBUG: Ensuring field order independence from section order');\n    \n    let leftColumn, rightColumn;\n    \n    if (leftSection === 'section1') {\n      // Company on left, Purchase Order on right\n      leftColumn = buildCompanyXML('left');\n      rightColumn = buildPurchaseOrderXML('right');\n      console.log('🔀 Using default order: Company left, Purchase Order right');\n    } else {\n      // Purchase Order on left, Company on right (sections swapped)\n      leftColumn = buildPurchaseOrderXML('left');\n      rightColumn = buildCompanyXML('right');\n      console.log('🔀 Using swapped order: Purchase Order left, Company right');\n    }\n    \n    // DEBUG: Verify that field order is preserved regardless of section position\n    console.log('🔍 DEBUG: Field order verification - Company fields should maintain custom order');\n    console.log('🔍 DEBUG: Final company XML will use fieldOrderData.companyFields order');\n    \n    return `\n      <table>\n        <tr>\n          ${leftColumn}\n          ${rightColumn}\n        </tr>\n      </table>\n    `;\n  };\n\n  // Build Vendor Information XML (dynamic label prefixing for all fields)\n  const buildVendorXML = () => {\n    // Get field order for vendor; fallback to current array order if not provided\n    const vendorFields = fieldOrderData.vendorFields || [];\n    const vendorFieldOrder = data.fieldOrder?.vendor || vendorFields.map(f => f.id);\n    \n    const orderedVendorFields = vendorFieldOrder.map(fieldId => vendorFields.find(f => f.id === fieldId)).filter(Boolean);\n    \n    const rows = orderedVendorFields.map(f => {\n      const raw = f.value || getVendorFieldValue(f.id, '');\n      const display = formatFieldWithLabel(f, raw);\n      return `<span data-field=\"${f.id}\">${display}</span>`;\n    }).join('<br/>');\n    \n    return `\n      <td style=\"width: 50%;\" data-subsection=\"vendor\">\n        <table>\n          <tr>\n            <td class=\"section-header\">VENDOR</td>\n          </tr>\n          <tr>\n            <td class=\"section-content\">${rows}</td>\n          </tr>\n        </table>\n      </td>\n    `;\n  };\n \n  // Build Ship To Information XML (dynamic label prefixing for all fields)\n  const buildShipToXML = () => {\n    // Get field order for ship-to; fallback to current array order if not provided\n    const shipToFields = fieldOrderData.shipToFields || [];\n    const shipToFieldOrder = data.fieldOrder?.shipTo || shipToFields.map(f => f.id);\n    \n    const orderedShipToFields = shipToFieldOrder.map(fieldId => shipToFields.find(f => f.id === fieldId)).filter(Boolean);\n    \n    const rows = orderedShipToFields.map(f => {\n      const raw = f.value || getShipToFieldValue(f.id, '');\n      const display = formatFieldWithLabel(f, raw);\n      return `<span data-field=\"${f.id}\">${display}</span>`;\n    }).join('<br/>');\n    \n    return `\n      <td style=\"width: 50%;\" data-subsection=\"ship-to\">\n        <table>\n          <tr>\n            <td class=\"section-header\">SHIP TO</td>\n          </tr>\n          <tr>\n            <td class=\"section-content\">${rows}</td>\n          </tr>\n        </table>\n      </td>\n    `;\n  };\n\n  // Build Vendor/Ship-To Section XML with dynamic ordering\n  const buildVendorShipToXML = () => {\n    // Get section order from data, default to [section3, section4] if not provided\n    const sectionOrder = data.sectionOrder?.sections3And4 || ['section3', 'section4'];\n    const leftSection = sectionOrder[0];\n    const rightSection = sectionOrder[1];\n    \n    console.log('🔀 Building vendor/ship-to section with order:', { leftSection, rightSection });\n    \n    let leftColumn, rightColumn;\n    \n    if (leftSection === 'section3') {\n      leftColumn = buildVendorXML();\n      rightColumn = buildShipToXML();\n    } else {\n      leftColumn = buildShipToXML();\n      rightColumn = buildVendorXML();\n    }\n    \n    return `\n      <table style=\"margin-top: 20px;\" data-section=\"vendor-ship-to\">\n        <tr>\n          ${leftColumn}\n          ${rightColumn}\n        </tr>\n      </table>\n    `;\n  };\n\n  // Build Line Items XML with dynamic column ordering\n  const buildLineItemsXML = () => {\n    // Get column order from data, default to standard order if not provided\n    const columnOrder = data.sectionOrder?.lineItemColumns || ['itemNumber', 'description', 'qty', 'rate', 'amount'];\n    \n    console.log('🔀 Building line items with column order:', columnOrder);\n    console.log('🔀 Line items data:', data.lineItems);\n    console.log('🔀 Column order from state:', data.sectionOrder?.lineItemColumns);\n    console.log('🔀 Full data object:', data);\n    \n    // Column configuration mapping\n    const columnConfig = {\n      itemNumber: { label: 'Item#', colSpan: 3, field: 'itemNumber' },\n      description: { label: 'Description', colSpan: 12, field: 'description' },\n      qty: { label: 'Qty', colSpan: 2, field: 'qty' },\n      rate: { label: 'Rate', colSpan: 3, field: 'rate' },\n      amount: { label: 'Amount', colSpan: 3, field: 'amount' }\n    };\n    \n    // Build header row\n    const headerRow = columnOrder.map(columnId => {\n      let config, label;\n      \n      if (columnId.startsWith('custom-')) {\n        // Handle custom columns\n        const customType = columnId.replace('custom-', '').split('-')[0]; // Get first part after 'custom-'\n        label = customType.charAt(0).toUpperCase() + customType.slice(1); // Capitalize first letter\n        config = { colSpan: 3 }; // Default colSpan for custom columns\n        console.log(`🔀 Custom column \"${columnId}\" -> label: \"${label}\", colSpan: ${config.colSpan}`);\n      } else {\n        // Handle standard columns\n        config = columnConfig[columnId];\n        label = config.label;\n        console.log(`🔀 Standard column \"${columnId}\" -> label: \"${label}\", colSpan: ${config.colSpan}`);\n      }\n      \n      return `<td class=\"item-header\" colSpan=\"${config.colSpan}\">${label}</td>`;\n    }).join('');\n    \n    // Build data rows using actual line item data\n    const lineItems = data.lineItems || [];\n    const actualRowCount = lineItems.length;\n    console.log(`🔀 Building ${actualRowCount} data rows from line items data`);\n    \n    const dataRows = lineItems.map((rowData, rowIndex) => {\n      const rowCells = columnOrder.map(columnId => {\n        let config, fieldValue;\n        \n        if (columnId.startsWith('custom-')) {\n          // Handle custom columns\n          config = { colSpan: 3 }; // Default colSpan for custom columns\n          fieldValue = rowData[columnId] || '-';\n          console.log(`🔀 Custom column \"${columnId}\" row ${rowIndex}: value = \"${fieldValue}\"`);\n        } else {\n          // Handle standard columns\n          config = columnConfig[columnId];\n          // Resolve value with fallbacks between UI keys and numeric keys\n          fieldValue = rowData[columnId];\n          if (fieldValue === undefined || fieldValue === null || fieldValue === '') {\n            if (columnId === 'qty') fieldValue = rowData.quantity;\n            else if (columnId === 'rate') fieldValue = rowData.unitPrice;\n            else if (columnId === 'amount') fieldValue = rowData.total;\n          }\n          if (fieldValue === undefined || fieldValue === null || fieldValue === '') fieldValue = '-';\n          console.log(`🔀 Standard column \"${columnId}\" row ${rowIndex}: value = \"${fieldValue}\"`);\n        }\n        \n        return `<td colSpan=\"${config.colSpan}\">${fieldValue}</td>`;\n      }).join('');\n      \n      return `<tr data-row-id=\"line-item-${rowIndex}\" data-row-index=\"${rowIndex}\">${rowCells}</tr>`;\n    }).join('');\n    \n    return `\n      <table style=\"margin-top: 15px;\" data-section=\"line-items\">\n        <tr>\n          ${headerRow}\n        </tr>\n        ${dataRows}\n      </table>\n    `;\n  };\n\n  // Build Comments Section XML\n  const buildCommentsXML = () => {\n    // Get comments fields order from data, default to standard order if not provided\n    const commentsFieldsOrder = data.commentsFields || [\n      { id: 'comments-main', label: 'Comments or Special Instructions:', value: '[Enter comments or special instructions...]' }\n    ];\n\n    // Helper function to get field value with fallbacks\n    const getCommentsFieldValue = (fieldId) => {\n      // Try data object first, then field value, then default\n      if (data[fieldId] !== undefined && String(data[fieldId]).trim()) {\n        return data[fieldId];\n      }\n      \n      const field = commentsFieldsOrder.find(f => f.id === fieldId);\n      if (field && field.value) {\n        return field.value;\n      }\n      \n      // Fallback to DOM lookup\n      const element = document.querySelector(`[data-field=\"${fieldId}\"] .editable-field`);\n      if (element && element.textContent.trim()) {\n        return element.textContent.trim();\n      }\n      \n      return '[Enter comments or special instructions...]';\n    };\n\n    // Build table rows dynamically based on commentsFields order\n    const commentsRows = commentsFieldsOrder.map(field => {\n      const value = getCommentsFieldValue(field.id);\n      return `\n        <tr>\n          <td class=\"comments-header\">${field.label}</td>\n        </tr>\n        <tr>\n          <td class=\"comments-content\">${value}</td>\n        </tr>\n      `;\n    }).join('');\n\n    return `\n      <td style=\"width: 50%;\" data-section=\"comments\">\n        <table>\n          ${commentsRows}\n        </table>\n      </td>\n    `;\n  };\n\n  // Build Contact Section XML\n  const buildContactXML = () => {\n    // Get contact fields order from data, default to standard order if not provided\n    const contactFieldsOrder = data.contactFields || [\n      { id: 'contact-main', label: 'Contact Information:', value: 'For inquiries, please contact us' }\n    ];\n\n    // Helper function to get field value with fallbacks\n    const getContactFieldValue = (fieldId) => {\n      // Try data object first, then field value, then default\n      if (data[fieldId] !== undefined && String(data[fieldId]).trim()) {\n        return data[fieldId];\n      }\n      \n      const field = contactFieldsOrder.find(f => f.id === fieldId);\n      if (field && field.value) {\n        return field.value;\n      }\n      \n      // Fallback to DOM lookup\n      const element = document.querySelector(`[data-field=\"${fieldId}\"] .editable-field`);\n      if (element && element.textContent.trim()) {\n        return element.textContent.trim();\n      }\n      \n      return 'For inquiries, please contact us';\n    };\n\n    // Build table rows dynamically based on contactFields order\n    const contactRows = contactFieldsOrder.map(field => {\n      const value = getContactFieldValue(field.id);\n      return `\n        <tr>\n          <td class=\"contact-header\">${field.label}</td>\n        </tr>\n        <tr>\n          <td class=\"contact-content\">${value}</td>\n        </tr>\n      `;\n    }).join('');\n\n    return `\n      <td class=\"contact-info\" style=\"width: 70%;\" data-field=\"contact-info\">\n        <table>\n          ${contactRows}\n        </table>\n      </td>\n    `;\n  };\n\n  // Build Totals Section XML\n  const buildTotalsXML = () => {\n    // Get totals fields order from data, default to standard order if not provided\n    const totalsFieldsOrder = data.totalsFields || [\n      { id: 'subtotal', label: 'SUBTOTAL:', value: '$0.00' },\n      { id: 'tax', label: 'TAX:', value: '$0.00' },\n      { id: 'shipping', label: 'SHIPPING:', value: '$0.00' },\n      { id: 'other', label: 'OTHER:', value: '$0.00' },\n      { id: 'total', label: 'TOTAL:', value: '$0.00' }\n    ];\n\n    // Helper function to get field value with fallbacks\n    const getFieldValue = (fieldId) => {\n      // Try data object first, then field value, then default\n      if (data[fieldId] !== undefined && String(data[fieldId]).trim()) {\n        return data[fieldId];\n      }\n      \n      const field = totalsFieldsOrder.find(f => f.id === fieldId);\n      if (field && field.value) {\n        return field.value;\n      }\n      \n      // Fallback to DOM lookup\n      const element = document.querySelector(`[data-field=\"${fieldId}\"] .editable-field, [data-field=\"${fieldId}\"] .calculated-field`);\n      if (element && element.textContent.trim()) {\n        return element.textContent.trim();\n      }\n      \n      return '$0.00';\n    };\n\n    // Build table rows dynamically based on totalsFields order\n    const totalsRows = totalsFieldsOrder.map(field => {\n      const value = getFieldValue(field.id);\n      return `\n        <tr>\n          <td class=\"total-label\">${field.label}</td>\n          <td class=\"total-amount\" align=\"right\">${value}</td>\n        </tr>\n      `;\n    }).join('');\n\n    // Use table rows/cells for maximum NetSuite/BFO compatibility (avoid nested divs)\n    return `\n      <td style=\"width: 50%;\" data-section=\"totals\">\n        <table>\n          <tr>\n            <td class=\"section-header\" colspan=\"2\">Totals</td>\n          </tr>\n          ${totalsRows}\n        </table>\n      </td>\n    `;\n  };\n\n  // Build Comments and Totals Section XML with dynamic ordering\n  const buildCommentsTotalsXML = () => {\n    // Get section order from data, default to [section8, section9] if not provided\n    const sectionOrder = data.sectionOrder?.sections8And9 || ['section8', 'section9'];\n    const leftSection = sectionOrder[0];\n    const rightSection = sectionOrder[1];\n    \n    console.log('🔀 Building comments/totals section with order:', { leftSection, rightSection });\n    \n    let leftColumn, rightColumn;\n    \n    if (leftSection === 'section8') {\n      leftColumn = buildCommentsXML();\n      rightColumn = buildTotalsXML();\n    } else {\n      leftColumn = buildTotalsXML();\n      rightColumn = buildCommentsXML();\n    }\n    \n    return `\n      <table style=\"margin-top: 15px;\" data-section=\"comments-totals\">\n        <tr>\n          ${leftColumn}\n          ${rightColumn}\n        </tr>\n      </table>\n    `;\n  };\n\n  // Helper function to get shipping details field values with dynamic ID support\n  const getShippingFieldValue = (fieldType, defaultValue = '') => {\n    // Try to get value from data object first (this includes custom columns)\n    if (data[fieldType] !== undefined && data[fieldType] !== '') {\n      return data[fieldType];\n    }\n    \n    const possibleSelectors = [\n      `.shipping-field-${fieldType} .editable-field`,\n      `.shipping-field[data-field=\"${fieldType}\"] .editable-field`,\n      `.shipping-${fieldType} .editable-field`,\n      `#shipping-${fieldType}`,\n      `[data-shipping-field=\"${fieldType}\"]`\n    ];\n    \n    // Try DOM selectors as fallback\n    for (const selector of possibleSelectors) {\n      const element = document.querySelector(selector);\n      if (element && element.textContent.trim()) {\n        return element.textContent.trim();\n      }\n    }\n    \n    return defaultValue;\n  };\n\n  // Helper function to get line item values with dynamic ID support\n  const getLineItemValue = (rowIndex, fieldType, defaultValue = '') => {\n    // Map template field names to live table data-column ids\n    const colIdMap = { quantity: 'qty', unitPrice: 'rate', total: 'amount' };\n    const colId = colIdMap[fieldType] || fieldType; // itemNumber, description pass through\n\n    const possibleSelectors = [\n      `#line-item-${rowIndex}-${fieldType}`,\n      `.line-item-row[data-row=\"${rowIndex}\"] .${colId}-field`,\n      `.itemtable tbody tr:nth-child(${rowIndex + 1}) .${colId}-field .editable-field`,\n      `.itemtable tbody tr:nth-child(${rowIndex + 1}) td[data-column=\"${colId}\"] .editable-field`,\n      `.itemtable tbody tr:nth-child(${rowIndex + 1}) td:nth-child(${getColumnIndex(fieldType)}) .editable-field`\n    ];\n    \n    // Try data object first\n    if (data.lineItems && data.lineItems[rowIndex] && data.lineItems[rowIndex][fieldType]) {\n      return data.lineItems[rowIndex][fieldType];\n    }\n    \n    // Try DOM selectors with debugging\n    for (const selector of possibleSelectors) {\n      const element = document.querySelector(selector);\n      const text = element ? element.textContent.trim() : '';\n      try { console.debug('🔎 XML getLineItemValue', { rowIndex, fieldType, colId, selector, found: !!element, text }); } catch {}\n      if (text) return text;\n    }\n    \n    return defaultValue;\n  };\n\n  // Helper function to get column index for line items\n  const getColumnIndex = (fieldType) => {\n    const columnMap = {\n      itemNumber: 2,\n      description: 3,\n      quantity: 4,\n      unitPrice: 5,\n      total: 6\n    };\n    return columnMap[fieldType] || 1;\n  };\n\n  // Helper function to get totals field values with dynamic ID support\n  const getTotalFieldValue = (fieldType, defaultValue = '') => {\n    const possibleSelectors = [\n      `#total-${fieldType}`,\n      `.total-${fieldType} .editable-field`,\n      `.total-row[data-field=\"${fieldType}\"] .editable-field`,\n      `.totals-section .${fieldType}-field .editable-field`,\n      // Subtotal and total are displayed as calculated spans\n      `.totals-section .total-row[data-field=\"subtotal\"] .calculated-field`,\n      `.totals-section .total-row[data-field=\"total\"] .total-field`\n    ];\n    \n    // Try data object first\n    if (data[fieldType]) {\n      return data[fieldType];\n    }\n    \n    // Try DOM selectors with debugging\n    for (const selector of possibleSelectors) {\n      const element = document.querySelector(selector);\n      const text = element ? element.textContent.trim() : '';\n      try { console.debug('🔎 XML getTotalFieldValue', { fieldType, selector, found: !!element, text }); } catch {}\n      if (text) return text;\n    }\n    \n    return defaultValue;\n  };\n\n  // Helper function to get comments field value with dynamic ID support\n  const getCommentsValue = (defaultValue = '') => {\n    const possibleSelectors = [\n      '#comments-field',\n      '.comments-content .editable-field',\n      '.comments-section .editable-field',\n      '[data-field=\"comments\"]'\n    ];\n    \n    // Try data object first\n    if (data.comments) {\n      return data.comments;\n    }\n    \n    // Try DOM selectors\n    for (const selector of possibleSelectors) {\n      const element = document.querySelector(selector);\n      if (element && element.textContent.trim()) {\n        return element.textContent.trim();\n      }\n    }\n    \n    return defaultValue;\n  };\n\n  // Helper function to get contact info field value with dynamic ID support\n  const getContactInfoValue = (defaultValue = '') => {\n    const possibleSelectors = [\n      '#contact-info-field',\n      '.contact-section .editable-field',\n      '.contact-info .editable-field',\n      '[data-field=\"contactInfo\"]'\n    ];\n    \n    // Try data object first\n    if (data.contactInfo) {\n      return data.contactInfo;\n    }\n    \n    // Try DOM selectors\n    for (const selector of possibleSelectors) {\n      const element = document.querySelector(selector);\n      if (element && element.textContent.trim()) {\n        return element.textContent.trim();\n      }\n    }\n    \n    return defaultValue;\n  };\n\n  // Generate line items XML with dynamic ID support\n  const generateLineItemsXML = () => {\n    const maxRows = 5; // Standard number of line item rows\n    \n    // Generate rows (either from data or empty placeholder rows)\n    return Array(maxRows).fill(0).map((_, index) => {\n      // Try to get values using dynamic ID system\n      const itemNumber = getLineItemValue(index, 'itemNumber', '-');\n      const description = getLineItemValue(index, 'description', '-');\n      const quantity = getLineItemValue(index, 'quantity', '-');\n      const unitPrice = getLineItemValue(index, 'unitPrice', '-');\n      const total = getLineItemValue(index, 'total', '-');\n      \n      return `\n        <tr data-row-id=\"line-item-${index}\" data-row-index=\"${index}\">\n            <td class=\"item-cell\" align=\"left\" colspan=\"3\" data-field=\"itemNumber\" data-row=\"${index}\">${itemNumber}</td>\n            <td class=\"item-cell\" align=\"left\" colspan=\"12\" data-field=\"description\" data-row=\"${index}\">${description}</td>\n            <td class=\"item-cell\" align=\"center\" colspan=\"2\" data-field=\"quantity\" data-row=\"${index}\">${quantity}</td>\n            <td class=\"item-cell\" align=\"right\" colspan=\"3\" data-field=\"unitPrice\" data-row=\"${index}\">${unitPrice}</td>\n            <td class=\"item-cell\" align=\"right\" colspan=\"3\" data-field=\"total\" data-row=\"${index}\">${total}</td>\n        </tr>`;\n    }).join('');\n  };\n\n  // Generate the complete XML using the new template structure\n  const xml = `<?xml version=\"1.0\"?>\n<!DOCTYPE pdf PUBLIC \"-//big.faceless.org//report\" \"report-1.1.dtd\">\n<pdf>\n<head>\n    <meta name=\"title\" value=\"Purchase Order\"/>\n    <meta name=\"author\" value=\"Purchase Order Generator\"/>\n    <meta name=\"subject\" value=\"Purchase Order\"/>\n    <meta name=\"creator\" value=\"Purchase Order Generator\"/>\n    <meta name=\"producer\" value=\"Purchase Order Generator\"/>\n    <meta name=\"creationDate\" value=\"${new Date().toISOString()}\"/>\n    <!-- Header Color Configuration -->\n    <!-- Generated at: ${new Date().toISOString()} -->\n    <!-- Header Background: ${headerColors.headerBackground} -->\n    <!-- Header Text: ${headerColors.headerText} -->\n    <!-- Header Border: ${headerColors.headerBorder} -->\n    <!-- Section Title Background: ${headerColors.sectionTitleBackground} -->\n    <!-- Section Title Text: ${headerColors.sectionTitleText} -->\n    <!-- All section headers (Purchase Order, Comments, Vendor, Ship To, etc.) now use section title colors -->\n    \n    <meta name=\"modDate\" value=\"${new Date().toISOString()}\"/>\n    <link name=\"NotoSans\" type=\"font\" subtype=\"truetype\" src=\"\\${nsfont.NotoSans_Regular}\" src-bold=\"\\${nsfont.NotoSans_Bold}\" src-italic=\"\\${nsfont.NotoSans_Italic}\" src-bolditalic=\"\\${nsfont.NotoSans_BoldItalic}\" bytes=\"2\" />\n    <style>\n        * { font-family: NotoSans, sans-serif; font-size: 9pt; }\n        table { width: 100%; border-collapse: collapse; }\n        .header-company { font-size: 14pt; font-weight: bold; }\n        .header-title { font-size: 20pt; font-weight: bold; background-color: ${headerColors.sectionTitleBackground}; color: ${headerColors.sectionTitleText}; padding: 6px; border: 1px solid #000; }\n        .header-info { font-size: 10pt; }\n        .section-header { background-color: ${headerColors.sectionTitleBackground}; color: ${headerColors.sectionTitleText}; font-weight: bold; padding: 6px; border: 1px solid #000; }\n        .section-content { padding: 6px; border: 1px solid #000; vertical-align: top; }\n        .item-header { background-color: ${headerColors.sectionTitleBackground}; color: ${headerColors.sectionTitleText}; font-weight: bold; padding: 8px; border: 1px solid #000; }\n        .item-cell { padding: 6px; border: 1px solid #000; }\n        .total-label { font-weight: bold; padding: 4px; }\n        .total-amount { font-weight: bold; padding: 4px; background-color: #ffff99; }\n        .comments-header { background-color: ${headerColors.sectionTitleBackground}; color: ${headerColors.sectionTitleText}; font-weight: bold; padding: 6px; border: 1px solid #000; }\n        .comments-content { padding: 6px; border: 1px solid #000; min-height: 40px; }\n        .contact-info { font-size: 8pt; }\n        \n        /* All section headers now use section title colors */\n        .section-header, .header-title, .comments-header, .item-header {\n            background-color: ${headerColors.sectionTitleBackground} !important;\n            color: ${headerColors.sectionTitleText} !important;\n        }\n    </style>\n</head>\n<body padding=\"0.5in\" size=\"Letter\">\n    \n    ${buildHeaderSectionXML()}\n    ${buildVendorShipToAndShippingDetailsXML()}\n\n\n    ${buildLineItemsXML()}\n\n\n    ${buildCommentsTotalsXML()}\n\n\n\n    <table style=\"margin-top: 20px;\" data-section=\"contact-signature\">\n        <tr>\n            ${buildContactXML()}\n            <td style=\"width: 30%; text-align: center;\" data-field=\"signature\">\n                <table style=\"width: 100%;\">\n                    <tr>\n                        <td style=\"border-top: 1px solid #000; padding-top: 10px;\">\n                            Authorized Signature\n                        </td>\n                    </tr>\n                </table>\n            </td>\n        </tr>\n    </table>\n</body>\n</pdf>`;\n\n  console.log('✅ DYNAMIC ID TEMPLATE: XML generated successfully with dynamic field support');\n  console.log('📄 XML preview (first 200 chars):', xml.substring(0, 200));\n  return xml;\n}\n\n// Export the template structure for reference with dynamic ID support\nexport const purchaseOrderTemplate = {\n  companyInfo: {\n    staticFields: ['company-name', 'company-address', 'company-city-state', 'company-phone', 'company-fax', 'company-website'],\n    dynamicPrefixes: ['company-field-', 'company-'],\n    dataAttribute: 'data-section=\"company-info\"'\n  },\n  purchaseOrder: {\n    staticFields: ['po-title', 'po-date', 'po-number'],\n    dynamicPrefixes: ['po-field-', 'po-'],\n    dataAttribute: 'data-section=\"purchase-order-info\"'\n  },\n  vendor: {\n    staticFields: ['vendor-company', 'vendor-contact', 'vendor-address', 'vendor-city-state', 'vendor-phone', 'vendor-fax'],\n    dynamicPrefixes: ['vendor-field-', 'vendor-'],\n    dataAttribute: 'data-subsection=\"vendor\"'\n  },\n  shipTo: {\n    staticFields: ['ship-to-name', 'ship-to-company', 'ship-to-address', 'ship-to-city-state', 'ship-to-phone', 'ship-to-fax'],\n    dynamicPrefixes: ['ship-to-field-', 'ship-to-'],\n    dataAttribute: 'data-subsection=\"ship-to\"'\n  },\n  shipping: {\n    staticFields: ['requisitioner', 'shipVia', 'fob', 'shippingTerms'],\n    dynamicPrefixes: ['shipping-field-', 'shipping-'],\n    dataAttribute: 'data-section=\"shipping-details\"'\n  },\n  lineItems: {\n    staticFields: ['itemNumber', 'description', 'quantity', 'unitPrice', 'total'],\n    dynamicPrefixes: ['line-item-', 'item-'],\n    dataAttribute: 'data-section=\"line-items\"',\n    maxRows: 5\n  },\n  totals: {\n    staticFields: ['subtotal', 'tax', 'shipping', 'other', 'total'],\n    dynamicPrefixes: ['total-', 'totals-'],\n    dataAttribute: 'data-subsection=\"totals\"'\n  },\n  comments: {\n    staticFields: ['comments'],\n    dynamicPrefixes: ['comments-field-', 'comment-'],\n    dataAttribute: 'data-subsection=\"comments\"'\n  },\n  contact: {\n    staticFields: ['contactInfo'],\n    dynamicPrefixes: ['contact-info-field-', 'contact-'],\n    dataAttribute: 'data-section=\"contact-signature\"'\n  }\n};\n\n// Export a simple function to get template structure\nexport function getTemplateStructure() {\n  return purchaseOrderTemplate;\n}\n\n// Dynamic ID Generation Utilities\nexport const dynamicIdUtils = {\n  // Generate a new dynamic ID with timestamp and random component\n  generateId: (prefix = 'field', section = 'general') => {\n    const timestamp = Date.now();\n    const random = Math.random().toString(36).substr(2, 9);\n    return `${section}-${prefix}-${timestamp}-${random}`;\n  },\n\n  // Generate multiple possible IDs for a field to try when looking up values\n  getPossibleIds: (staticId, section = 'unknown') => {\n    const baseName = staticId.replace(/^(company-|po-|vendor-|ship-to-)/, '');\n    return [\n      staticId, // Try static ID first\n      `${section}-field-${staticId}`,\n      `${section}-${baseName}`,\n      `${staticId}-${Date.now()}`,\n      `field-${baseName}`,\n      baseName\n    ];\n  },\n\n  // Validate if an ID follows our dynamic ID pattern\n  isValidDynamicId: (id) => {\n    const dynamicPattern = /^[a-z-]+-(field-)?[a-z-]+(-\\d+)?(-[a-z0-9]+)?$/;\n    return dynamicPattern.test(id);\n  },\n\n  // Extract the base field type from any ID (static or dynamic)\n  getFieldType: (id) => {\n    // Remove common prefixes and suffixes to get the core field type\n    return id\n      .replace(/^(company-|po-|vendor-|ship-to-|shipping-|total-|line-item-|comments-|contact-)/, '')\n      .replace(/-(field-)?(\\d+)?(-[a-z0-9]+)?$/, '')\n      .replace(/^(field-)?/, '');\n  },\n\n  // Get section from ID\n  getSection: (id) => {\n    if (id.startsWith('company-')) return 'company';\n    if (id.startsWith('po-')) return 'purchase-order';\n    if (id.startsWith('vendor-')) return 'vendor';\n    if (id.startsWith('ship-to-')) return 'ship-to';\n    if (id.startsWith('shipping-')) return 'shipping';\n    if (id.startsWith('line-item-')) return 'line-items';\n    if (id.startsWith('total-')) return 'totals';\n    if (id.startsWith('comments-')) return 'comments';\n    if (id.startsWith('contact-')) return 'contact';\n    return 'unknown';\n  }\n};\n\n// Field Mapping Utilities\nexport const fieldMappingUtils = {\n  // Map all known static field IDs to their readable names\n  staticFieldNames: {\n    // Company fields\n    'company-name': 'Company Name',\n    'company-address': 'Street Address',\n    'company-city-state': 'City, State, ZIP',\n    'company-phone': 'Phone Number',\n    'company-fax': 'Fax Number',\n    'company-website': 'Website',\n    \n    // Purchase Order fields\n    'po-title': 'Purchase Order Title',\n    'po-date': 'Date',\n    'po-number': 'PO Number',\n    \n    // Vendor fields\n    'vendor-company': 'Vendor Company',\n    'vendor-contact': 'Vendor Contact',\n    'vendor-address': 'Vendor Address',\n    'vendor-city-state': 'Vendor City/State',\n    'vendor-phone': 'Vendor Phone',\n    'vendor-fax': 'Vendor Fax',\n    \n    // Ship To fields\n    'ship-to-name': 'Ship To Name',\n    'ship-to-company': 'Ship To Company',\n    'ship-to-address': 'Ship To Address',\n    'ship-to-city-state': 'Ship To City/State',\n    'ship-to-phone': 'Ship To Phone',\n    'ship-to-fax': 'Ship To Fax',\n    \n    // Shipping fields\n    'requisitioner': 'Requisitioner',\n    'shipVia': 'Ship Via',\n    'fob': 'F.O.B.',\n    'shippingTerms': 'Shipping Terms',\n    \n    // Line item fields\n    'itemNumber': 'Item Number',\n    'description': 'Description',\n    'quantity': 'Quantity',\n    'unitPrice': 'Unit Price',\n    'total': 'Total',\n    \n    // Totals fields\n    'subtotal': 'Subtotal',\n    'tax': 'Tax',\n    'shipping': 'Shipping',\n    'other': 'Other',\n    \n    // Other fields\n    'comments': 'Comments',\n    'contactInfo': 'Contact Information'\n  },\n\n  // Get human-readable name for any field ID\n  getFieldName: (id) => {\n    const staticName = fieldMappingUtils.staticFieldNames[id];\n    if (staticName) return staticName;\n    \n    // For dynamic IDs, try to extract the base field type\n    const fieldType = dynamicIdUtils.getFieldType(id);\n    const staticFieldName = fieldMappingUtils.staticFieldNames[fieldType];\n    if (staticFieldName) return staticFieldName;\n    \n    // Fallback: humanize the ID\n    return id.replace(/[-_]/g, ' ').replace(/\\b\\w/g, l => l.toUpperCase());\n  },\n\n  // Get all field IDs for a section\n  getFieldsForSection: (section) => {\n    const template = purchaseOrderTemplate[section];\n    return template ? template.staticFields : [];\n  }\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}