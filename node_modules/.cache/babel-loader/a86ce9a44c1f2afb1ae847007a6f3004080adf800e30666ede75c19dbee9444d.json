{"ast":null,"code":"// AI provider hook - uses ChatGPT API directly\n// Set REACT_APP_OPENAI_API_KEY in your .env file to keep the key secure\n\nexport function useAIProvider() {\n  const apiKey = process.env.REACT_APP_OPENAI_API_KEY;\n  async function getFieldSuggestions(payload) {\n    if (!apiKey) {\n      throw new Error('OpenAI API key not configured. Set REACT_APP_OPENAI_API_KEY in your .env file');\n    }\n    try {\n      var _payload$companyField, _payload$purchaseOrde, _payload$vendorFields, _payload$shipToFields, _data$choices$, _data$choices$$messag;\n      const response = await fetch('https://api.openai.com/v1/chat/completions', {\n        method: 'POST',\n        headers: {\n          'Authorization': `Bearer ${apiKey}`,\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          model: 'gpt-5',\n          messages: [{\n            role: 'system',\n            content: `You are a helpful assistant that fills out purchase order forms. \n              Analyze the provided fields and return realistic, business-appropriate values.\n              Return ONLY a JSON object with field IDs as keys and suggested values as strings.\n              Example: {\"company-name\": \"Acme Corporation\", \"po-number\": \"PO-2024-001\"}`\n          }, {\n            role: 'user',\n            content: `Please fill out these purchase order fields with realistic business data:\n              Company Fields: ${(_payload$companyField = payload.companyFields) === null || _payload$companyField === void 0 ? void 0 : _payload$companyField.map(f => `${f.id}: ${f.label}`).join(', ')}\n              Purchase Order Fields: ${(_payload$purchaseOrde = payload.purchaseOrderFields) === null || _payload$purchaseOrde === void 0 ? void 0 : _payload$purchaseOrde.map(f => `${f.id}: ${f.label}`).join(', ')}\n              Vendor Fields: ${(_payload$vendorFields = payload.vendorFields) === null || _payload$vendorFields === void 0 ? void 0 : _payload$vendorFields.map(f => `${f.id}: ${f.label}`).join(', ')}\n              Ship To Fields: ${(_payload$shipToFields = payload.shipToFields) === null || _payload$shipToFields === void 0 ? void 0 : _payload$shipToFields.map(f => `${f.id}: ${f.label}`).join(', ')}\n              \n              Return only valid JSON with field IDs as keys.`\n          }],\n          temperature: 1,\n          max_completion_tokens: 1000\n        })\n      });\n      if (!response.ok) {\n        var _errorData$error;\n        const errorData = await response.json();\n        throw new Error(`OpenAI API error: ${((_errorData$error = errorData.error) === null || _errorData$error === void 0 ? void 0 : _errorData$error.message) || response.statusText}`);\n      }\n      const data = await response.json();\n      const content = (_data$choices$ = data.choices[0]) === null || _data$choices$ === void 0 ? void 0 : (_data$choices$$messag = _data$choices$.message) === null || _data$choices$$messag === void 0 ? void 0 : _data$choices$$messag.content;\n      if (!content) {\n        throw new Error('No response content from OpenAI');\n      }\n\n      // Parse the JSON response, tolerate code fences or extra text, and filter to known field IDs\n      try {\n        // Remove possible Markdown code fences\n        let cleaned = content.trim();\n        if (cleaned.startsWith('```')) {\n          cleaned = cleaned.replace(/^```(?:json)?\\s*/i, '').replace(/```$/i, '').trim();\n        }\n        let parsed;\n        try {\n          parsed = JSON.parse(cleaned);\n        } catch (innerErr) {\n          // Try extracting the first JSON object if extra prose is present\n          const firstBrace = cleaned.indexOf('{');\n          const lastBrace = cleaned.lastIndexOf('}');\n          if (firstBrace !== -1 && lastBrace !== -1 && lastBrace > firstBrace) {\n            const maybeJson = cleaned.slice(firstBrace, lastBrace + 1);\n            parsed = JSON.parse(maybeJson);\n          } else {\n            throw innerErr;\n          }\n        }\n\n        // Build allowlist of known field IDs from the payload\n        const allowedIds = [...(payload.companyFields || []).map(f => f.id), ...(payload.purchaseOrderFields || []).map(f => f.id), ...(payload.vendorFields || []).map(f => f.id), ...(payload.shipToFields || []).map(f => f.id)];\n        const suggestions = Object.fromEntries(Object.entries(parsed || {}).filter(([key, value]) => typeof value === 'string' && allowedIds.includes(key)));\n        return {\n          suggestions\n        };\n      } catch (parseError) {\n        console.error('Failed to parse OpenAI response:', content);\n        throw new Error('Invalid JSON response from AI - please try again');\n      }\n    } catch (error) {\n      console.error('OpenAI API call failed:', error);\n      throw error;\n    }\n  }\n  return {\n    getFieldSuggestions\n  };\n}","map":{"version":3,"names":["useAIProvider","apiKey","process","env","REACT_APP_OPENAI_API_KEY","getFieldSuggestions","payload","Error","_payload$companyField","_payload$purchaseOrde","_payload$vendorFields","_payload$shipToFields","_data$choices$","_data$choices$$messag","response","fetch","method","headers","body","JSON","stringify","model","messages","role","content","companyFields","map","f","id","label","join","purchaseOrderFields","vendorFields","shipToFields","temperature","max_completion_tokens","ok","_errorData$error","errorData","json","error","message","statusText","data","choices","cleaned","trim","startsWith","replace","parsed","parse","innerErr","firstBrace","indexOf","lastBrace","lastIndexOf","maybeJson","slice","allowedIds","suggestions","Object","fromEntries","entries","filter","key","value","includes","parseError","console"],"sources":["/Users/waleed/Documents/GitHub/Cadbury3/src/hooks/useAIProvider.js"],"sourcesContent":["// AI provider hook - uses ChatGPT API directly\n// Set REACT_APP_OPENAI_API_KEY in your .env file to keep the key secure\n\nexport function useAIProvider() {\n  const apiKey = process.env.REACT_APP_OPENAI_API_KEY;\n\n  async function getFieldSuggestions(payload) {\n    if (!apiKey) {\n      throw new Error('OpenAI API key not configured. Set REACT_APP_OPENAI_API_KEY in your .env file');\n    }\n\n    try {\n      const response = await fetch('https://api.openai.com/v1/chat/completions', {\n        method: 'POST',\n        headers: {\n          'Authorization': `Bearer ${apiKey}`,\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({\n          model: 'gpt-5',\n          messages: [\n            {\n              role: 'system',\n              content: `You are a helpful assistant that fills out purchase order forms. \n              Analyze the provided fields and return realistic, business-appropriate values.\n              Return ONLY a JSON object with field IDs as keys and suggested values as strings.\n              Example: {\"company-name\": \"Acme Corporation\", \"po-number\": \"PO-2024-001\"}`\n            },\n            {\n              role: 'user',\n              content: `Please fill out these purchase order fields with realistic business data:\n              Company Fields: ${payload.companyFields?.map(f => `${f.id}: ${f.label}`).join(', ')}\n              Purchase Order Fields: ${payload.purchaseOrderFields?.map(f => `${f.id}: ${f.label}`).join(', ')}\n              Vendor Fields: ${payload.vendorFields?.map(f => `${f.id}: ${f.label}`).join(', ')}\n              Ship To Fields: ${payload.shipToFields?.map(f => `${f.id}: ${f.label}`).join(', ')}\n              \n              Return only valid JSON with field IDs as keys.`\n            }\n          ],\n          temperature: 1,\n          max_completion_tokens: 1000\n        })\n      });\n\n      if (!response.ok) {\n        const errorData = await response.json();\n        throw new Error(`OpenAI API error: ${errorData.error?.message || response.statusText}`);\n      }\n\n      const data = await response.json();\n      const content = data.choices[0]?.message?.content;\n      \n      if (!content) {\n        throw new Error('No response content from OpenAI');\n      }\n\n      // Parse the JSON response, tolerate code fences or extra text, and filter to known field IDs\n      try {\n        // Remove possible Markdown code fences\n        let cleaned = content.trim();\n        if (cleaned.startsWith('```')) {\n          cleaned = cleaned.replace(/^```(?:json)?\\s*/i, '').replace(/```$/i, '').trim();\n        }\n\n        let parsed;\n        try {\n          parsed = JSON.parse(cleaned);\n        } catch (innerErr) {\n          // Try extracting the first JSON object if extra prose is present\n          const firstBrace = cleaned.indexOf('{');\n          const lastBrace = cleaned.lastIndexOf('}');\n          if (firstBrace !== -1 && lastBrace !== -1 && lastBrace > firstBrace) {\n            const maybeJson = cleaned.slice(firstBrace, lastBrace + 1);\n            parsed = JSON.parse(maybeJson);\n          } else {\n            throw innerErr;\n          }\n        }\n\n        // Build allowlist of known field IDs from the payload\n        const allowedIds = [\n          ...(payload.companyFields || []).map(f => f.id),\n          ...(payload.purchaseOrderFields || []).map(f => f.id),\n          ...(payload.vendorFields || []).map(f => f.id),\n          ...(payload.shipToFields || []).map(f => f.id)\n        ];\n\n        const suggestions = Object.fromEntries(\n          Object.entries(parsed || {}).filter(([key, value]) =>\n            typeof value === 'string' && allowedIds.includes(key)\n          )\n        );\n\n        return { suggestions };\n      } catch (parseError) {\n        console.error('Failed to parse OpenAI response:', content);\n        throw new Error('Invalid JSON response from AI - please try again');\n      }\n    } catch (error) {\n      console.error('OpenAI API call failed:', error);\n      throw error;\n    }\n  }\n\n  return { getFieldSuggestions };\n}\n\n\n"],"mappings":"AAAA;AACA;;AAEA,OAAO,SAASA,aAAaA,CAAA,EAAG;EAC9B,MAAMC,MAAM,GAAGC,OAAO,CAACC,GAAG,CAACC,wBAAwB;EAEnD,eAAeC,mBAAmBA,CAACC,OAAO,EAAE;IAC1C,IAAI,CAACL,MAAM,EAAE;MACX,MAAM,IAAIM,KAAK,CAAC,+EAA+E,CAAC;IAClG;IAEA,IAAI;MAAA,IAAAC,qBAAA,EAAAC,qBAAA,EAAAC,qBAAA,EAAAC,qBAAA,EAAAC,cAAA,EAAAC,qBAAA;MACF,MAAMC,QAAQ,GAAG,MAAMC,KAAK,CAAC,4CAA4C,EAAE;QACzEC,MAAM,EAAE,MAAM;QACdC,OAAO,EAAE;UACP,eAAe,EAAE,UAAUhB,MAAM,EAAE;UACnC,cAAc,EAAE;QAClB,CAAC;QACDiB,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;UACnBC,KAAK,EAAE,OAAO;UACdC,QAAQ,EAAE,CACR;YACEC,IAAI,EAAE,QAAQ;YACdC,OAAO,EAAE;AACvB;AACA;AACA;UACY,CAAC,EACD;YACED,IAAI,EAAE,MAAM;YACZC,OAAO,EAAE;AACvB,gCADuB,CAAAhB,qBAAA,GACSF,OAAO,CAACmB,aAAa,cAAAjB,qBAAA,uBAArBA,qBAAA,CAAuBkB,GAAG,CAACC,CAAC,IAAI,GAAGA,CAAC,CAACC,EAAE,KAAKD,CAAC,CAACE,KAAK,EAAE,CAAC,CAACC,IAAI,CAAC,IAAI,CAAC;AACjG,uCADiG,CAAArB,qBAAA,GAC1DH,OAAO,CAACyB,mBAAmB,cAAAtB,qBAAA,uBAA3BA,qBAAA,CAA6BiB,GAAG,CAACC,CAAC,IAAI,GAAGA,CAAC,CAACC,EAAE,KAAKD,CAAC,CAACE,KAAK,EAAE,CAAC,CAACC,IAAI,CAAC,IAAI,CAAC;AAC9G,+BAD8G,CAAApB,qBAAA,GAC/EJ,OAAO,CAAC0B,YAAY,cAAAtB,qBAAA,uBAApBA,qBAAA,CAAsBgB,GAAG,CAACC,CAAC,IAAI,GAAGA,CAAC,CAACC,EAAE,KAAKD,CAAC,CAACE,KAAK,EAAE,CAAC,CAACC,IAAI,CAAC,IAAI,CAAC;AAC/F,gCAD+F,CAAAnB,qBAAA,GAC/DL,OAAO,CAAC2B,YAAY,cAAAtB,qBAAA,uBAApBA,qBAAA,CAAsBe,GAAG,CAACC,CAAC,IAAI,GAAGA,CAAC,CAACC,EAAE,KAAKD,CAAC,CAACE,KAAK,EAAE,CAAC,CAACC,IAAI,CAAC,IAAI,CAAC;AAChG;AACA;UACY,CAAC,CACF;UACDI,WAAW,EAAE,CAAC;UACdC,qBAAqB,EAAE;QACzB,CAAC;MACH,CAAC,CAAC;MAEF,IAAI,CAACrB,QAAQ,CAACsB,EAAE,EAAE;QAAA,IAAAC,gBAAA;QAChB,MAAMC,SAAS,GAAG,MAAMxB,QAAQ,CAACyB,IAAI,CAAC,CAAC;QACvC,MAAM,IAAIhC,KAAK,CAAC,qBAAqB,EAAA8B,gBAAA,GAAAC,SAAS,CAACE,KAAK,cAAAH,gBAAA,uBAAfA,gBAAA,CAAiBI,OAAO,KAAI3B,QAAQ,CAAC4B,UAAU,EAAE,CAAC;MACzF;MAEA,MAAMC,IAAI,GAAG,MAAM7B,QAAQ,CAACyB,IAAI,CAAC,CAAC;MAClC,MAAMf,OAAO,IAAAZ,cAAA,GAAG+B,IAAI,CAACC,OAAO,CAAC,CAAC,CAAC,cAAAhC,cAAA,wBAAAC,qBAAA,GAAfD,cAAA,CAAiB6B,OAAO,cAAA5B,qBAAA,uBAAxBA,qBAAA,CAA0BW,OAAO;MAEjD,IAAI,CAACA,OAAO,EAAE;QACZ,MAAM,IAAIjB,KAAK,CAAC,iCAAiC,CAAC;MACpD;;MAEA;MACA,IAAI;QACF;QACA,IAAIsC,OAAO,GAAGrB,OAAO,CAACsB,IAAI,CAAC,CAAC;QAC5B,IAAID,OAAO,CAACE,UAAU,CAAC,KAAK,CAAC,EAAE;UAC7BF,OAAO,GAAGA,OAAO,CAACG,OAAO,CAAC,mBAAmB,EAAE,EAAE,CAAC,CAACA,OAAO,CAAC,OAAO,EAAE,EAAE,CAAC,CAACF,IAAI,CAAC,CAAC;QAChF;QAEA,IAAIG,MAAM;QACV,IAAI;UACFA,MAAM,GAAG9B,IAAI,CAAC+B,KAAK,CAACL,OAAO,CAAC;QAC9B,CAAC,CAAC,OAAOM,QAAQ,EAAE;UACjB;UACA,MAAMC,UAAU,GAAGP,OAAO,CAACQ,OAAO,CAAC,GAAG,CAAC;UACvC,MAAMC,SAAS,GAAGT,OAAO,CAACU,WAAW,CAAC,GAAG,CAAC;UAC1C,IAAIH,UAAU,KAAK,CAAC,CAAC,IAAIE,SAAS,KAAK,CAAC,CAAC,IAAIA,SAAS,GAAGF,UAAU,EAAE;YACnE,MAAMI,SAAS,GAAGX,OAAO,CAACY,KAAK,CAACL,UAAU,EAAEE,SAAS,GAAG,CAAC,CAAC;YAC1DL,MAAM,GAAG9B,IAAI,CAAC+B,KAAK,CAACM,SAAS,CAAC;UAChC,CAAC,MAAM;YACL,MAAML,QAAQ;UAChB;QACF;;QAEA;QACA,MAAMO,UAAU,GAAG,CACjB,GAAG,CAACpD,OAAO,CAACmB,aAAa,IAAI,EAAE,EAAEC,GAAG,CAACC,CAAC,IAAIA,CAAC,CAACC,EAAE,CAAC,EAC/C,GAAG,CAACtB,OAAO,CAACyB,mBAAmB,IAAI,EAAE,EAAEL,GAAG,CAACC,CAAC,IAAIA,CAAC,CAACC,EAAE,CAAC,EACrD,GAAG,CAACtB,OAAO,CAAC0B,YAAY,IAAI,EAAE,EAAEN,GAAG,CAACC,CAAC,IAAIA,CAAC,CAACC,EAAE,CAAC,EAC9C,GAAG,CAACtB,OAAO,CAAC2B,YAAY,IAAI,EAAE,EAAEP,GAAG,CAACC,CAAC,IAAIA,CAAC,CAACC,EAAE,CAAC,CAC/C;QAED,MAAM+B,WAAW,GAAGC,MAAM,CAACC,WAAW,CACpCD,MAAM,CAACE,OAAO,CAACb,MAAM,IAAI,CAAC,CAAC,CAAC,CAACc,MAAM,CAAC,CAAC,CAACC,GAAG,EAAEC,KAAK,CAAC,KAC/C,OAAOA,KAAK,KAAK,QAAQ,IAAIP,UAAU,CAACQ,QAAQ,CAACF,GAAG,CACtD,CACF,CAAC;QAED,OAAO;UAAEL;QAAY,CAAC;MACxB,CAAC,CAAC,OAAOQ,UAAU,EAAE;QACnBC,OAAO,CAAC5B,KAAK,CAAC,kCAAkC,EAAEhB,OAAO,CAAC;QAC1D,MAAM,IAAIjB,KAAK,CAAC,kDAAkD,CAAC;MACrE;IACF,CAAC,CAAC,OAAOiC,KAAK,EAAE;MACd4B,OAAO,CAAC5B,KAAK,CAAC,yBAAyB,EAAEA,KAAK,CAAC;MAC/C,MAAMA,KAAK;IACb;EACF;EAEA,OAAO;IAAEnC;EAAoB,CAAC;AAChC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}